<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[底层代码构造sql忽略NUll条件]]></title>
      <url>https://smallwenzi.github.io/2019/05/06/A%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>代码没有判断查询的值null，导致把全部数据load内存里，这样系统崩溃</p>
<p>代码：com.amway.common.jpa.repository.JpaRepoUtil<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private static StringBuilder generateQlForQueryByProperties(Map&lt;String, Object&gt; propertiesMap,</span><br><span class="line">		StringBuilder ql, Map&lt;Integer, Object&gt; params, FindByPropertiesType findType) &#123;</span><br><span class="line">	int index = 0;</span><br><span class="line">	</span><br><span class="line">	if (propertiesMap != null &amp;&amp; !propertiesMap.isEmpty()) &#123;</span><br><span class="line">		boolean doDeleteAnd = false, doDeletewWere = true;</span><br><span class="line">		ql.append(&quot; where &quot;);</span><br><span class="line">        for (Entry&lt;String,Object&gt; entry: propertiesMap.entrySet()) &#123;</span><br><span class="line">        	Object value = entry.getValue();</span><br><span class="line">               //忽略null 的值</span><br><span class="line">        	if (value != null) &#123;</span><br><span class="line">        		if (doDeletewWere) </span><br><span class="line">        			doDeletewWere = false;</span><br><span class="line">        		</span><br><span class="line">        		if (value instanceof String &amp;&amp; (findType == null || FindByPropertiesType.Fuzzy.equals(findType))) &#123;</span><br><span class="line">        			String valueStr = (String) entry.getValue();</span><br><span class="line">        			ql.append(&quot;upper(model.&quot; + entry.getKey() + &quot;) like :propertyValue&quot; + index + &quot; and &quot;);</span><br><span class="line">        			params.put(index++, &quot;%&quot; + valueStr.trim().toUpperCase() + &quot;%&quot;);</span><br><span class="line">        		&#125; else if(QueryValue.NULL.equals(value)) &#123;</span><br><span class="line">        			ql.append(&quot;model.&quot; + entry.getKey() + &quot; is null and &quot;);</span><br><span class="line">        		&#125; else if(QueryValue.NotNull.equals(value)) &#123;</span><br><span class="line">        			ql.append(&quot;model.&quot; + entry.getKey() + &quot; is not null and &quot;);</span><br><span class="line">        		&#125; else &#123;</span><br><span class="line">        			ql.append(&quot;model.&quot; + entry.getKey() + &quot;=:propertyValue&quot; + index + &quot; and &quot;);</span><br><span class="line">        			params.put(index++, entry.getValue());</span><br><span class="line">        		&#125;</span><br><span class="line">        		</span><br><span class="line">        		doDeleteAnd = true;</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (doDeleteAnd)</span><br><span class="line">        	ql = ql.delete(ql.toString().lastIndexOf(&quot; and &quot;), ql.toString().length());</span><br><span class="line">        if (doDeletewWere)</span><br><span class="line">       		ql = ql.delete(ql.toString().lastIndexOf(&quot; where &quot;), ql.toString().length());</span><br><span class="line">	&#125;</span><br><span class="line">	return ql;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/2019/05/06/A问题/1.png" alt="upload successful"></p>
<p>总结：需要深度了解底层代码。</p>
]]></content>
      
        
        <tags>
            
            <tag> jpa </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[在windows下atom上搭建PlantUML书写环境]]></title>
      <url>https://smallwenzi.github.io/2018/10/14/windows%E4%B8%8Batom%E4%B8%8A%E6%90%AD%E5%BB%BAPlantUML%E4%B9%A6%E5%86%99%E7%8E%AF%E5%A2%83/</url>
      <content type="html"><![CDATA[<p>PlantUML是一款使用纯文本绘制UML图的开源软件。它的优点是能够帮助作者把精力集中到内容的书写上而不是格式的调整。本文介绍了一种在windows环境下atom编辑器上搭建PlantUML书写环境的方法。</p>
<h1 id="工具准备"><a href="#工具准备" class="headerlink" title="工具准备"></a>工具准备</h1><ul>
<li>atom</li>
<li>graphviz<br><a href="http://www.graphviz.org/" target="_blank" rel="noopener">Graphviz</a>是一款开源图形可视化软件。Atom的PlantUML插件使用graphviz将PlantUML语言绘制成相应的图形。<h1 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h1>github上已经有开发者为atom开发了PlantUML相关的插件。这里推荐以下两个插件</li>
<li>language-plantuml</li>
<li>plantuml-viewer<br>其中language-plantuml提供了PlantUML语法高亮支持，plantuml-viewer负责把PlantUML语句转化为对应的UML图。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">有很多博客使用plantuml-preview。本人试用了这两款插件，发现都能很好的支持PlantUML。</span><br><span class="line">但是plantuml-viewer更有优势：plantuml-viewer能够实时显示PlantUML语言描述的图形，</span><br><span class="line">并且可以通过鼠标滚轮流畅的调节图形大小。此外，plantuml-preview需要显式的配置java和plantuml.jar，</span><br><span class="line">而plantuml-viewer不需要，因此我推荐plantuml-viewer</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>安装方法很简单：atom下 File -&gt; Settings -&gt; Install<br><img src="/2018/10/14/windows下atom上搭建PlantUML书写环境/plantuml_plugin.png" alt="logo"></p>
<h1 id="配置插件"><a href="#配置插件" class="headerlink" title="配置插件"></a>配置插件</h1><p>plantuml-viewer按如下配置<br><img src="/2018/10/14/windows下atom上搭建PlantUML书写环境/plantuml_viewer_setting.png" alt="logo"></p>
<ul>
<li>Charset配置成utf-8在生成图形的时候中文不会乱码</li>
<li>graphviz从官网下载后安装到自定义位置，在plant-viewer中指定dot.exe路径</li>
</ul>
<h1 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h1><p>用PlantUML生成工厂模式UML<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@startuml</span><br><span class="line">skinparam classAttributeIconSize 0</span><br><span class="line">class Product</span><br><span class="line">class ConcreteProduct</span><br><span class="line">class Creator &#123;</span><br><span class="line">  + &#123;abstract&#125; FactoryMethod()</span><br><span class="line">&#125;</span><br><span class="line">class ConcreteCreator &#123;</span><br><span class="line">  + FactoryMethod()</span><br><span class="line">&#125;</span><br><span class="line">Product &lt;|-- ConcreteProduct</span><br><span class="line">Creator &lt;|-- ConcreteCreator</span><br><span class="line">ConcreteProduct &lt;.l. ConcreteCreator</span><br><span class="line">note left of Product: 定义工厂方法所创建的对象的接口</span><br><span class="line">note right of Creator: 声明工厂方法，该方法返回一个Product类型的对象</span><br><span class="line">note left of ConcreteProduct: 具体产品，实现了Product的接口</span><br><span class="line">note right of ConcreteCreator: 重定义工厂方法以返回一个ConcreteProduct实例</span><br><span class="line">@enduml</span><br></pre></td></tr></table></figure></p>
<p>效果图<br><img src="/2018/10/14/windows下atom上搭建PlantUML书写环境/3.png" alt="logo"></p>
<p><a href="http://plantuml.com/" target="_blank" rel="noopener">plantuml语法</a></p>
]]></content>
      
        <categories>
            
            <category> atom </category>
            
        </categories>
        
        
        <tags>
            
            <tag> plantuml </tag>
            
            <tag> atom </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Solr的主从模式Master-Slave]]></title>
      <url>https://smallwenzi.github.io/2018/10/14/olr%E7%9A%84%E4%B8%BB%E4%BB%8E%E6%A8%A1%E5%BC%8FMaster-Slave/</url>
      <content type="html"><![CDATA[<h1 id="摘要："><a href="#摘要：" class="headerlink" title="摘要："></a>摘要：</h1><p>如今，为了提高Solr的搜索速度，使其具有很好的容灾能力，往往会配置SolrCloud，但在Solr4之前，还有一种很流行的方式，Master-Slave模式，为什么要提及这种方式，因为我们公司目前用的就是这种方式。</p>
<h1 id="引入Master-Slave"><a href="#引入Master-Slave" class="headerlink" title="引入Master-Slave"></a>引入Master-Slave</h1><p>Solr在查询的时候，特别忌讳进行写操作，因为它是IO阻塞型的。现在的流行的Elasticsearch就对此有很好的改进。在引入Master-Slave以后，将读写分配到不同的服务器上，你可以使用master来做索引，然后使用slaves来做查询。<br>1.在多台服务器上分别搭建好可以独立运行的Solr，参见<a href="https://smallwenzi.github.io/2018/10/13/lr%E6%95%99%E7%A8%8B/">这里</a><br>2.指定其中的一台为Master，只需要在SolrConifg.xml中配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;requestHandler name=&quot;/replication&quot; class=&quot;solr.ReplicationHandler&quot;&gt;</span><br><span class="line">     &lt;lst name=&quot;master&quot;&gt;</span><br><span class="line">         &lt;str name=&quot;enable&quot;&gt;$&#123;enable.master:true&#125;&lt;/str&gt;</span><br><span class="line">         &lt;!--</span><br><span class="line">             Create a backup after &apos;optimize&apos;. Other values can be &apos;commit&apos;, &apos;startup&apos;.</span><br><span class="line">             It is possible to have multiple entries of this config string.</span><br><span class="line">             Note that this is just for backup, replication does not require this.</span><br><span class="line">         --&gt;</span><br><span class="line">         &lt;str name=&quot;backupAfter&quot;&gt;optimize&lt;/str&gt;</span><br><span class="line">         &lt;!-- Replicate on &apos;commit&apos;. &apos;startup&apos; and &apos;optimize&apos; are also the valid values for replicateAfter. --&gt;</span><br><span class="line">         &lt;str name=&quot;replicateAfter&quot;&gt;commit&lt;/str&gt;</span><br><span class="line">         &lt;!-- If configuration files need to be replicated give the names here, separated by comma --&gt;</span><br><span class="line">         &lt;str name=&quot;confFiles&quot;&gt;schema.xml,dict.txt,synonyms.txt&lt;/str&gt;</span><br><span class="line">         &lt;str name=&quot;commitReserveDuration&quot;&gt;00:00:10&lt;/str&gt;</span><br><span class="line">     &lt;/lst&gt;</span><br><span class="line">     &lt;int name=&quot;maxNumberOfBackups&quot;&gt;2&lt;/int&gt;</span><br><span class="line">        &lt;/requestHandler&gt;</span><br></pre></td></tr></table></figure></p>
<p>3.指定其他多有的服务为Slave，只需要分别SolrConifg.xml配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;requestHandler name=&quot;/replication&quot; class=&quot;solr.ReplicationHandler&quot; &gt;</span><br><span class="line">  &lt;lst name=&quot;slave&quot;&gt;</span><br><span class="line">      &lt;str name=&quot;enable&quot;&gt;$&#123;enable.slave:true&#125;&lt;/str&gt;</span><br><span class="line">      &lt;str name=&quot;masterUrl&quot;&gt;http://192.168.1.102:8983/solr/jcg&lt;/str&gt;</span><br><span class="line">      &lt;str name=&quot;pollInterval&quot;&gt;00:00:10&lt;/str&gt;</span><br><span class="line">      &lt;str name=&quot;httpConnTimeout&quot;&gt;5000&lt;/str&gt;</span><br><span class="line">      &lt;str name=&quot;httpReadTimeout&quot;&gt;10000&lt;/str&gt;</span><br><span class="line">   &lt;/lst&gt;</span><br><span class="line">&lt;/requestHandler&gt;</span><br></pre></td></tr></table></figure></p>
<p>4.重启所有的master-slave服务即可</p>
]]></content>
      
        <categories>
            
            <category> solr </category>
            
        </categories>
        
        
        <tags>
            
            <tag> solr </tag>
            
            <tag> solr-master </tag>
            
            <tag> solr-slave </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[solr教程]]></title>
      <url>https://smallwenzi.github.io/2018/10/13/lr%E6%95%99%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h1 id="1-为什么选择Apache-Solr"><a href="#1-为什么选择Apache-Solr" class="headerlink" title="1.为什么选择Apache Solr"></a>1.为什么选择Apache Solr</h1><p>Apache Solr是一个功能强大的搜索服务器，它支持REST风格API。Solr是基于Lucene的，Lucene 支持强大的匹配能力，如短语，通配符，连接，分组和更多不同的数据类型。它使用 Apache Zookeeper特别针对高流量进行优化。Apache Solr提供各式各样的功能，我们列出了部分最主要的功能。</p>
<ul>
<li>先进的全文搜索功能。</li>
<li>XML，JSON和HTTP - 基于开放接口标准。</li>
<li>高度可扩展和容错。</li>
<li>同时支持模式和无模式配置。</li>
<li>分页搜索和过滤。</li>
<li>支持像英语，德语，中国，日本，法国和许多主要语言</li>
<li>丰富的文档分析。</li>
</ul>
<h1 id="安装solr"><a href="#安装solr" class="headerlink" title="安装solr"></a>安装solr</h1><p>要首先让从以下位置下载最新版本的Apache Solr：<br><a href="http://lucene.apache.org/solr/downloads.html" target="_blank" rel="noopener">http://lucene.apache.org/solr/downloads.html</a><br>在撰写本文时，可用的稳定版本是7.4.0。<br>一旦Solr的zip文件下载将它解压缩到一个文件夹。提取的文件夹看起来像下面。<br><img src="/2018/10/13/lr教程/1.png" alt="logo"><br>Solr的文件夹</p>
<p>bin文件夹中包含用来启动和停止服务器的脚本。example 文件夹包含几个示例文件。我们将使用其中的一种，以说明Solr如何索引数据。server 文件夹包含logs 文件夹，所有的Solr的日志都写入该文件夹。这将有助于索引过程来检查任何错误日志。在sever文件夹下的Solr文件夹包含不同的集合或核心（core/collection）。对于各集合或核心的配置和数据都存储在相应的集合或核心文件夹。<br>Apache Solr带有一个内置的Jetty服务器。但在我们开始之前，我们必须验证JAVA_HOME已经配置。<br>我们可以使用命令行脚本启动服务器。让我们去solr的bin目录，从命令提示符输入出以下命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solr start</span><br></pre></td></tr></table></figure></p>
<p>这将启动下的默认端口8983 Solr的服务器。</p>
<p>现在，我们可以在浏览器中打开以下网址和验证，我们的Solr的实例正在运行。solr的管理工具的细节超出了示例的范围。</p>
<p><a href="http://localhost:8983/Solr/" target="_blank" rel="noopener">http://localhost:8983/Solr/</a><br><img src="/2018/10/13/lr教程/2.png" alt="logo"></p>
<h1 id="配置Apache-Solr"><a href="#配置Apache-Solr" class="headerlink" title="配置Apache Solr"></a>配置Apache Solr</h1><p>在本节中，我们将告诉你如何配置的核心/集合作为Solr实例，以及如何定义的字段。Apache Solr附带称为无模式模式的选项。这个选项允许用户构建有效的架构，而无需手动编辑模式文件。但是，在这个例子中，我们将使用架构配置理解Solr的内部。</p>
<h2 id="建立核心（core）"><a href="#建立核心（core）" class="headerlink" title="建立核心（core）"></a>建立核心（core）</h2><p>当Solr的服务器在独立模式下启动的配置称为核心，当它在SolrCloud模式启动的配置称为集合。在这个例子中，我们将有关独立服务器和核心讨论。我们将在以后再讨论SolrCloud。首先，我们需要创建一个核心的索引数据。Solr的创建命令有以下选项：</p>
<p>-c <name> -要创建的核心或集合的名称（必需）。<br>-d <confdir> -配置目录，在SolrCloud模式非常有用。<br>-n <configname> -配置名称。这将默认为核心或集合的名称。<br>-p <port> -本地Solr的实例的端口发送create命令; 默认脚本试图通过寻找运行Solr的实例来检测端口。<br>-s <shards> -Number of shards to split a collection into, default is 1.<br>-rf <replicas> -集合中的每个文件的份数。默认值是1。<br>在这个例子中，我们将使用的核心名称和配置目录-d参数-c参数。对于所有其它参数我们使用默认设置。</replicas></shards></port></configname></confdir></name></p>
<p>现在在命令窗口浏览 solr-7.4.0\bin文件夹，并发出以下命令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solr create -c jcg</span><br></pre></td></tr></table></figure></p>
<p>我们可以看到在命令窗口中下面的输出。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Creating new core &apos;jcg&apos; using command:</span><br><span class="line">http://localhost:8983/solr/admin/cores?action=CREATE&amp;name=jcg&amp;instanceDir=jcg</span><br><span class="line"> &#123;</span><br><span class="line"> &quot;responseHeader&quot;:&#123;</span><br><span class="line"> &quot;status&quot;:0,</span><br><span class="line"> &quot;QTime&quot;:663&#125;,</span><br><span class="line"> &quot;core&quot;:&quot;jcg&quot;&#125;</span><br><span class="line"> ``` </span><br><span class="line">现在我们导航到以下网址，我们可以看到JCG核心被填充在核心选择器上。还可以看到核心的统计信息。</span><br><span class="line">http://localhost:8983/Solr</span><br><span class="line">![logo](lr教程/3.png)</span><br><span class="line"></span><br><span class="line">## 修改Schema.xml文件</span><br><span class="line">我们需要修改schema.xml中文件的文件夹下，server\solr\jcg\conf包含的字段。我们将使用随Solr的安装索引附带的示例文件“books.csv”之一。该文件所在的文件夹下  的solr-7.4.0\example\exampledocs</span><br><span class="line"></span><br><span class="line">现在，我们定位到该文件夹  server\solr目录。你会看到一个名为JCG的文件夹被创建。子文件夹conf和data分别拥有核心的配置和索引的数据。</span><br><span class="line">现在编辑\server\solr\jcg\conf\server\solr\jcg\conf\schema.xml文件，设置唯一元素后添加以下内容。</span><br><span class="line">我们已经设置了属性索引为true。这指定字段用于索引和记录可以使用索引进行检索。该值设置为false将只存储领域，但不能进行查询。</span><br><span class="line">另外请注意另一个属性stored并将其设置为true。这指定字段被存储，并且可以在输出被返回。将此字段设置为假将使字段唯一索引，并且不能在输出进行检索。</span><br><span class="line">我们已经分配给存在于此处的“books.csv”文件中的字段的类型。在CSV文件“ID”第一场由索引Schema.xml文件的唯一键自动元素的照顾。如果你注意，我们已经略过字段series_t，sequence_i和genre_s未做任何条目。但是，当我们执行索引时，所有这些字段都被索引且没有任何问题。如果你想知道这种情况需要在Schema.xml文件的dynamicField部分一探究竟。</span><br><span class="line">[schema.xml](schema.xml)</span><br><span class="line"></span><br><span class="line">既然我们已经修改了配置，我们必须停止和启动服务器。要做到这一点，我们需要通过命令行发出从bin目录下面的命令。</span><br></pre></td></tr></table></figure></p>
<p>Solr  stop -all<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">服务器将停止现在。现在启动服务器问题从bin目录中通过命令行运行以下命令。</span><br></pre></td></tr></table></figure></p>
<p>Solr start<br>```</p>
<h1 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h1><p>Apache Solr带有一个叫做SimplePostTool独立的Java程序。这个程序被打包成JAR,在安装目录下 example\exampledocs可看到。<br>现在，我们在命令行定位到example\exampledocs文件夹，然后键入以下命令。你会看到一堆选项，使用的工具。<br><img src="/2018/10/13/lr教程/4.png" alt="logo"><br>正如我们前面所说，我们将索引“books.csv”文件中的数据。我们将导航到solr-7.4.0\example\exampledocs在命令提示符并发出以下命令。<br><img src="/2018/10/13/lr教程/5.png" alt="logo"><br>现在我们导航到以下网址并选择核心JCG。<br><a href="http://localhost:8983/solr" target="_blank" rel="noopener">http://localhost:8983/solr</a><br><img src="/2018/10/13/lr教程/6.png" alt="logo"><br>Solr的JCG核心数据<br>就拿在统计部分仔细一看，该民文档参数将显示索引的行数。</p>
<h1 id="访问索引的文档"><a href="#访问索引的文档" class="headerlink" title="访问索引的文档"></a>访问索引的文档</h1><p>Apache Solr提供了一种基于REST API来访问的数据，并还提供了不同的参数，以检索数据。我们将向您展示一些基于场景的查询。</p>
<h2 id="按名称搜索"><a href="#按名称搜索" class="headerlink" title="按名称搜索"></a>按名称搜索</h2><p>我们将用它的名字检索书的细节。要做到这一点，我们将使用下面的语法。URL中的参数“Q”是查询事件。<br>打开浏览器下列URL。<br><a href="http://localhost:8983/solr/jcg/select?q=name:&quot;A" target="_blank" rel="noopener">http://localhost:8983/solr/jcg/select?q=name:&quot;A</a> Clash of Kings”<br>输出将在下面，如图所示。<br><img src="/2018/10/13/lr教程/7.png" alt="logo"></p>
<h2 id="首字母搜索"><a href="#首字母搜索" class="headerlink" title="首字母搜索"></a>首字母搜索</h2><p>现在我们将告诉你如何搜索记录，如果我们只知道起始字母或单词，不记得完整的标题。我们可以用下面的查询检索结果。<br><a href="http://localhost:8983/solr/jcg/select?q=name:&quot;A" target="_blank" rel="noopener">http://localhost:8983/solr/jcg/select?q=name:&quot;A</a>“<br>输出将列出所有的书籍字母A盯着<br><img src="/2018/10/13/lr教程/8.png" alt="logo"></p>
<h2 id="搜索使用通配符"><a href="#搜索使用通配符" class="headerlink" title="搜索使用通配符"></a>搜索使用通配符</h2><p>Solr的支持通配符搜索。我们将下面的展示如何检索所有书名包含“of”的书。<br><a href="http://localhost:8983/solr/jcg/select?q=name:&quot;*of" target="_blank" rel="noopener">http://localhost:8983/solr/jcg/select?q=name:&quot;*of</a>“<br><img src="/2018/10/13/lr教程/9.png" alt="logo"></p>
<h2 id="搜索使用的条件"><a href="#搜索使用的条件" class="headerlink" title="搜索使用的条件"></a>搜索使用的条件</h2><p>Solr的支持条件的搜索。我们可以设置条件，我们的查询提供了“FQ”参数。在下面我们将告诉你如何查询价格低于￥6的书。<br><a href="http://localhost:8983/solr/jcg/select?q=*&amp;fq=price:[0" target="_blank" rel="noopener">http://localhost:8983/solr/jcg/select?q=*&amp;fq=price:[0</a> TO 6]<br>输出将只列出这是低于$ 6的书籍。<br><img src="/2018/10/13/lr教程/10.png" alt="logo"></p>
]]></content>
      
        <categories>
            
            <category> solr </category>
            
        </categories>
        
        
        <tags>
            
            <tag> solr </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[docker的使用]]></title>
      <url>https://smallwenzi.github.io/2018/06/11/docker%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>1 docker build出现Temporary failure resolving<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi/etc/systemd/system/multi-user.target.wants/docker.service ExecStart=/usr/bin/dockerd </span><br><span class="line">添加 --dns=8.8.8.8</span><br><span class="line">重新加载配置</span><br><span class="line">&gt;systemctl daemon-reload </span><br><span class="line"> --启动docker</span><br><span class="line">&gt;systemctl start docker</span><br></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> docker </category>
            
        </categories>
        
        
        <tags>
            
            <tag> docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[十二 jenkins 配置maven打包git代码]]></title>
      <url>https://smallwenzi.github.io/2018/05/11/-jenkins-%E9%85%8D%E7%BD%AEmaven%E6%89%93%E5%8C%85git%E4%BB%A3%E7%A0%81/</url>
      <content type="html"><![CDATA[<p>一 <a href="/2018/05/11/-jenkins-配置git证书/">jenkins-配置git证书</a><br>二 <a href="/2018/05/08/安装jenkins/">安装jenkins</a><br>三 <a href="/2018/05/11/enkinx-配置任务/">jenkins 配置java和Maven环境</a></p>
<p><img src="/2018/05/11/-jenkins-配置maven打包git代码/总图.png" alt="logo"></p>
<h1 id="一配置任务"><a href="#一配置任务" class="headerlink" title="一配置任务"></a>一配置任务</h1><p>1.1点击 创建一个新任务<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/1.png" alt="logo"><br>1.2 输入名称  选择自由风格的软件项目<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/2.png" alt="logo"><br>1.3新增文本参数<br>1.3.1参数docker.image.prefix: 私有库域名<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/3.png" alt="logo"><br>1.3.2参数docker.registry：私有库地址<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/4.png" alt="logo"><br>1.3.3参数docker.servcerId：刚才maven配置 私有库用户名和密码<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/5.png" alt="logo"><br>1.3.4参数version<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/6.png" alt="logo"><br>1.4配置 git库<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/7.png" alt="logo"><br>1.5构建步骤添加 执行Shell脚本<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/8.png" alt="logo"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">脚本命令：</span><br><span class="line">echo $WORKSPACE</span><br><span class="line">echo $MAVEN_HOME</span><br><span class="line">cd $WORKSPACE/Eureka</span><br><span class="line">$MAVEN_HOME/bin/mvn clean package docker:build -DpushImage -Ddocker.image.prefix=$docker_image_prefix -Ddocker.registry=$docker_registry -Ddocker.servcerId=$docker_servcerId -Dtag.version=$version</span><br></pre></td></tr></table></figure></p>
<p>保存</p>
<h1 id="二-配置jenkins用户可以执行docker-命令"><a href="#二-配置jenkins用户可以执行docker-命令" class="headerlink" title="二 配置jenkins用户可以执行docker 命令"></a>二 配置jenkins用户可以执行docker 命令</h1><p>liunx用户 使用jenkins 用户启动jenkins<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/systemd/system/multi-user.target.wants/docker.service</span><br><span class="line"> ExecStart=/usr/bin/dockerd  -G jenkins</span><br></pre></td></tr></table></figure></p>
<p> -G表示 jenkins用户可以执行docker 命令<br> <img src="/2018/05/11/-jenkins-配置maven打包git代码/9.png" alt="logo"></p>
<p> 重新加载配置<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure></p>
<p>  重新启动docker<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></p>
<h1 id="三执行任务"><a href="#三执行任务" class="headerlink" title="三执行任务"></a>三执行任务</h1><p>3.1 点击 Build with Parameters<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/10.png" alt="logo"><br>3.2 点击开始创建<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/11.png" alt="logo"><br>3.3查看脚本执行情况<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/12.png" alt="logo"><br>3.4成功后查看私有仓库目录<br><img src="/2018/05/11/-jenkins-配置maven打包git代码/132.png" alt="logo"></p>
]]></content>
      
        <categories>
            
            <category> jenkins </category>
            
        </categories>
        
        
        <tags>
            
            <tag> docker </tag>
            
            <tag> git </tag>
            
            <tag> maven </tag>
            
            <tag> jenkins </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[十一 jenkins 配置git证书]]></title>
      <url>https://smallwenzi.github.io/2018/05/11/-jenkins-%E9%85%8D%E7%BD%AEgit%E8%AF%81%E4%B9%A6/</url>
      <content type="html"><![CDATA[<p><a href="/2018/05/08/三）linux-安装-GIT（root用户）/">linux 安装 GIT（root用户）</a><br><a href="/2018/05/08/安装jenkins/">安装jenkins</a></p>
<h1 id="一-linux-生成RSA-key"><a href="#一-linux-生成RSA-key" class="headerlink" title="一 linux 生成RSA key"></a>一 linux 生成RSA key</h1><p>linux远程登录ssh ywtan@localhost<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/05/11/-jenkins-配置git证书/1.png" alt="logo"></p>
<p>全部回车<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .ssh/id_rsa(这是刚才设置 rsa_key)</span><br></pre></td></tr></table></figure></p>
<h1 id="二-jenkins-配置git证书"><a href="#二-jenkins-配置git证书" class="headerlink" title="二 jenkins 配置git证书"></a>二 jenkins 配置git证书</h1><p>2.1 在jenkins 页面点击credentials<br><img src="/2018/05/11/-jenkins-配置git证书/2.png" alt="logo"><br>2.2 点击 system<br><img src="/2018/05/11/-jenkins-配置git证书/3.png" alt="logo"><br>2.3 点击 Global credentials (unrestricted)<br><img src="/2018/05/11/-jenkins-配置git证书/4.png" alt="logo"><br>2.4 add Credentials<br><img src="/2018/05/11/-jenkins-配置git证书/5.png" alt="logo"><br>2.5 如图所示填写， key是刚才生成的key，最后点击保存<br><img src="/2018/05/11/-jenkins-配置git证书/6.png" alt="logo"></p>
]]></content>
      
        <categories>
            
            <category> jenkins </category>
            
        </categories>
        
        
        <tags>
            
            <tag> git </tag>
            
            <tag> jenkins </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[十）jenkins 配置java和Maven环境]]></title>
      <url>https://smallwenzi.github.io/2018/05/11/enkinx-%E9%85%8D%E7%BD%AE%E4%BB%BB%E5%8A%A1/</url>
      <content type="html"><![CDATA[<p>参考：<br><a href="/2018/05/11/九-linux配置java和maven/">linux配置java和maven</a><br><a href="2018/05/08/（六）docker安装本地仓库（root用户）/">docker安装本地仓库</a><br><a href="/2018/05/08/安装jenkins/">安装jenkins</a></p>
<h1 id="一配置maven"><a href="#一配置maven" class="headerlink" title="一配置maven"></a>一配置maven</h1><p>/app/apache-maven-3.2.3/conf/settings.xml<br>库位置<br><img src="/2018/05/11/enkinx-配置任务/1.png" alt="logo"><br>以下是私有docker库 用户名密码）<br><img src="/2018/05/11/enkinx-配置任务/2.png" alt="logo"></p>
<h1 id="二-jenkins-配置java和Maven环境"><a href="#二-jenkins-配置java和Maven环境" class="headerlink" title="二 jenkins 配置java和Maven环境"></a>二 jenkins 配置java和Maven环境</h1><p>2.1点击系统管理<br><img src="/2018/05/11/enkinx-配置任务/11278290-aab55082195f5c56.png" alt="logo"><br>2.2 点击 全局工具配置<br><img src="/2018/05/11/enkinx-配置任务/3.png" alt="logo"><br>2.3 如下图配置 java和maven.<br><img src="/2018/05/11/enkinx-配置任务/4.png" alt="logo"></p>
<p><img src="/2018/05/11/enkinx-配置任务/5.png" alt="logo"><br>2.4 点击 保存 再次点击 系统设置<br><img src="/2018/05/11/enkinx-配置任务/6.png" alt="logo"><br>2.5 再次配置java和maven目录<br><img src="/2018/05/11/enkinx-配置任务/7.png" alt="logo"></p>
]]></content>
      
        <categories>
            
            <category> jenkins </category>
            
        </categories>
        
        
        <tags>
            
            <tag> docker </tag>
            
            <tag> maven </tag>
            
            <tag> jenkins </tag>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[九 linux配置java和maven]]></title>
      <url>https://smallwenzi.github.io/2018/05/11/%E4%B9%9D-linux%E9%85%8D%E7%BD%AEjava%E5%92%8Cmaven/</url>
      <content type="html"><![CDATA[<p>安装链接：<br><a href="/2018/05/08/）oracle-VM安装red-hat-liunx/">oracle VM安装red hat liunx</a></p>
<h1 id="安装java"><a href="#安装java" class="headerlink" title="安装java"></a>安装java</h1><p>1 从<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a> 页面下载jdk-8u171-linux-x64.tar.gz<br>2 上传文件至linux服务器 /app<br>3 在/app目录 执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf jdk-8u171-linux-x64.tar.gz</span><br></pre></td></tr></table></figure></p>
<h1 id="安装maven"><a href="#安装maven" class="headerlink" title="安装maven:"></a>安装maven:</h1><p>1 在linux里/app执行：wget <a href="https://archive.apache.org/dist/maven/maven-3/3.2.3/binaries/apache-maven-3.2.3-bin.tar.gz" target="_blank" rel="noopener">https://archive.apache.org/dist/maven/maven-3/3.2.3/binaries/apache-maven-3.2.3-bin.tar.gz</a><br>2 在/app目录 执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf  apache-maven-3.2.3-bin.tar.gz</span><br></pre></td></tr></table></figure></p>
<p>3 在/app/apache-maven-3.2.3/bin 目录执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x ./mvn</span><br></pre></td></tr></table></figure></p>
<h1 id="配置环境-root用户"><a href="#配置环境-root用户" class="headerlink" title="配置环境(root用户)"></a>配置环境(root用户)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure>
<p>配置maven 和java环境<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export MAVEN_HOME=/app/apache-maven-3.2.3</span><br><span class="line">export MAVEN_HOME</span><br><span class="line">export PATH=$PATH:$MAVEN_HOME/bin</span><br><span class="line">export JAVA_HOME=/app/jdk1.8.0_171</span><br><span class="line">export JAVA_HOME</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure></p>
<p>保存完成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></p>
<h1 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -v</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> maven </tag>
            
            <tag> java </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[八）安装jenkins]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%E5%AE%89%E8%A3%85jenkins/</url>
      <content type="html"><![CDATA[<p>参考：</p>
<p>1<a href="/2018/05/08/）oracle-VM安装red-hat-liunx/">oracle VM安装red hat liunx</a></p>
<p>2<a href="/2018/05/08/）Red-Hat-升级-rpm软件、YUM软件（root用户）/">升级RPM和YUM 包</a></p>
<h1 id="1-安装java环境"><a href="#1-安装java环境" class="headerlink" title="1 安装java环境"></a>1 安装java环境</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y java</span><br></pre></td></tr></table></figure>
<h1 id="2-安装wget"><a href="#2-安装wget" class="headerlink" title="2 安装wget"></a>2 安装wget</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget</span><br></pre></td></tr></table></figure>
<h1 id="3-获取jenkins的配置"><a href="#3-获取jenkins的配置" class="headerlink" title="3 获取jenkins的配置"></a>3 获取jenkins的配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins.io/redhat/jenkins.repo</span><br></pre></td></tr></table></figure>
<h1 id="4-导入jenkinskey"><a href="#4-导入jenkinskey" class="headerlink" title="4 导入jenkinskey"></a>4 导入jenkinskey</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> rpm --import http://pkg.jenkins.io/redhat/jenkins.io.key</span><br><span class="line"> ``</span><br><span class="line"></span><br><span class="line"># 5 安装jenkins</span><br></pre></td></tr></table></figure>
<p>yum install jenkins<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 6 jenkins的配置文件：</span><br></pre></td></tr></table></figure></p>
<p>/etc/sysconfig/jenkins<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 7 运行 jenkins</span><br></pre></td></tr></table></figure></p>
<p>service jenkins start<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 8 查看日志：</span><br></pre></td></tr></table></figure></p>
<p>tail-f  /var/log/jenkins/jenkins.log<br>```<br><img src="/2018/05/08/安装jenkins/11278290-b7f1229f3c16a906.png" alt="logo"><br>211是jenkins key</p>
<p>如果不能访问请关闭防火墙<br>iptables -F</p>
<h1 id="9-浏览器访问：192-168-137-8：8080"><a href="#9-浏览器访问：192-168-137-8：8080" class="headerlink" title="9 浏览器访问：192.168.137.8：8080"></a>9 浏览器访问：192.168.137.8：8080</h1><p><img src="/2018/05/08/安装jenkins/11278290-e2f6e1054f7f923a.png" alt="logo"><br>输入21120240a2cb4e8e83065dc7c71a5b88<br>点击确定</p>
<h1 id="10-安装推荐的插件"><a href="#10-安装推荐的插件" class="headerlink" title="10 安装推荐的插件"></a>10 安装推荐的插件</h1><p><img src="/2018/05/08/安装jenkins/11278290-9e1548cc032d002c.png" alt="logo"></p>
<h1 id="11-等等安装完成"><a href="#11-等等安装完成" class="headerlink" title="11  等等安装完成"></a>11  等等安装完成</h1><p><img src="/2018/05/08/安装jenkins/11278290-a2000d90816960d4.png" alt="logo"><br>12 创建用户:  输入完信息 点击 确定：<br><img src="/2018/05/08/安装jenkins/11278290-364c455c39845e06.png" alt="logo"><br>13 点击save and finish</p>
<p><img src="/2018/05/08/安装jenkins/11278290-6cce522c3a59044b.png" alt="logo"><br>14 安装成功<br><img src="/2018/05/08/安装jenkins/11278290-aab55082195f5c56.png" alt="logo"></p>
]]></content>
      
        
        <tags>
            
            <tag> jenkins </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[spring cloud+docker+git+maven+jenkins+Kubernetes 目录]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/ring-cloud-docker-git-maven-jenkins-Kubernetes-%E7%9B%AE%E5%BD%95/</url>
      <content type="html"><![CDATA[<p>图：<br><img src="/2018/05/08/ring-cloud-docker-git-maven-jenkins-Kubernetes-目录/11278290-faac5fbb39c76314.png" alt="logo"></p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[七）maven build docker and push Image]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%E4%B8%83%EF%BC%89maven-build-docker-and-push-Image/</url>
      <content type="html"><![CDATA[<p>链接：<a href="/2018/05/08/（六）docker安装本地仓库（root用户）/">docker安装本地仓库</a><br>使用maven 打包jar成docker镜像 并发布到镜像库</p>
<h1 id="1-maven-settings-xml配置server-节点添加"><a href="#1-maven-settings-xml配置server-节点添加" class="headerlink" title="1 maven settings.xml配置server 节点添加"></a>1 maven settings.xml配置server 节点添加</h1><p>（这是私有库 用户名密码）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;server&gt;</span><br><span class="line">		&lt;id&gt;docker-hub&lt;/id&gt;</span><br><span class="line">		&lt;username&gt;testuser&lt;/username&gt;</span><br><span class="line">		&lt;password&gt;testpassword&lt;/password&gt;</span><br><span class="line">      &lt;/server&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="2-项目-pom-xml"><a href="#2-项目-pom-xml" class="headerlink" title="2 项目 pom.xml"></a>2 项目 pom.xml</h1><p>properties 节点</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> &lt;docker.image.prefix&gt;reg.itmuch.com&lt;/docker.image.prefix&gt;</span><br><span class="line">&lt;docker.registry&gt;https://reg.itmuch.com/v1&lt;/docker.registry&gt;</span><br><span class="line">   &lt;tag.version&gt;1.0.0&lt;/tag.version&gt;</span><br><span class="line">    &lt;docker.servcerId&gt;docker-hub&lt;/docker.servcerId&gt;</span><br></pre></td></tr></table></figure>
<p>maven 配置组件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">    &lt;!-- docker的maven插件，官网：https://github.com/spotify/docker-maven-plugin --&gt;</span><br><span class="line">       &lt;plugin&gt;</span><br><span class="line">           &lt;groupId&gt;com.spotify&lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">           &lt;dependencies&gt;</span><br><span class="line">           &lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;commons-logging&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.1.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">           &lt;/dependencies&gt;</span><br><span class="line">           &lt;configuration&gt;</span><br><span class="line">              	&lt;!-- 镜像名:tag  --&gt;</span><br><span class="line">              &lt;imageName&gt;$&#123;docker.image.prefix&#125;/$&#123;project.artifactId&#125;:$&#123;tag.version&#125;&lt;/imageName&gt;</span><br><span class="line">   &lt;!-- 指定Dockerfile所在的路径  --&gt;</span><br><span class="line">               &lt;dockerDirectory&gt;$&#123;project.basedir&#125;/docker&lt;/dockerDirectory&gt;</span><br><span class="line">               &lt;!-- 以下两行是为了docker push到DockerHub使用的。 --&gt;</span><br><span class="line">               &lt;serverId&gt;$&#123;docker.servcerId&#125;&lt;/serverId&gt;</span><br><span class="line">               &lt;registryUrl&gt;$&#123;docker.registry&#125;&lt;/registryUrl&gt;</span><br><span class="line">   			   &lt;resources&gt;</span><br><span class="line">                   &lt;resource&gt;</span><br><span class="line">                       &lt;targetPath&gt;/&lt;/targetPath&gt;</span><br><span class="line">                       &lt;directory&gt;$&#123;project.build.directory&#125;&lt;/directory&gt;</span><br><span class="line">                       &lt;include&gt;$&#123;project.build.finalName&#125;.jar&lt;/include&gt;</span><br><span class="line">                   &lt;/resource&gt;</span><br><span class="line">               &lt;/resources&gt;</span><br><span class="line">           &lt;/configuration&gt;</span><br><span class="line">       &lt;/plugin&gt;</span><br></pre></td></tr></table></figure></p>
<p>参考<a href="https://github.com/spotify/docker-maven-plugin" target="_blank" rel="noopener">https://github.com/spotify/docker-maven-plugin</a></p>
<h1 id="3-dockerFile文件放在项目根目录下docker目录"><a href="#3-dockerFile文件放在项目根目录下docker目录" class="headerlink" title="3 dockerFile文件放在项目根目录下docker目录"></a>3 dockerFile文件放在项目根目录下docker目录</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FROM openjre</span><br><span class="line">MAINTAINER killko &lt;ydhana@isoftstone.com&gt;</span><br><span class="line">ENV EUREKA_INSTANCE_NAME=eureka</span><br><span class="line">ENV EUREKA_SERVICEURL=http://eureka:6080/eureka</span><br><span class="line">EXPOSE 6080</span><br><span class="line">#统一时区</span><br><span class="line">RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai  /etc/localtime</span><br><span class="line"></span><br><span class="line">COPY eureka*.jar /Eureka.jar</span><br><span class="line"></span><br><span class="line">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;-Djava.net.preferIPv4Stack=true&quot;,&quot;/Eureka.jar&quot;]</span><br></pre></td></tr></table></figure>
<h1 id="4-maven-build-docker-and-push-Image："><a href="#4-maven-build-docker-and-push-Image：" class="headerlink" title="4 maven build docker and push Image："></a>4 maven build docker and push Image：</h1><p>mvn clean package docker:build -DpushImage</p>
<p>（需要注意：运行环境必须有docker）</p>
]]></content>
      
        <categories>
            
            <category> docker </category>
            
        </categories>
        
        
        <tags>
            
            <tag> docker </tag>
            
            <tag> maven </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[docker -mysql]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/ocker-mysql/</url>
      <content type="html"><![CDATA[<p>参考：<br><a href="/2018/05/08/（四）安装docker（root用户）/">安装docker</a></p>
<h1 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql</span><br></pre></td></tr></table></figure>
<h1 id="运行镜像"><a href="#运行镜像" class="headerlink" title="运行镜像"></a>运行镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name mysql -p 3306:3306 -v /app/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=root -d mysql</span><br></pre></td></tr></table></figure>
<h1 id="进入mysql进行设置"><a href="#进入mysql进行设置" class="headerlink" title="进入mysql进行设置"></a>进入mysql进行设置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a  --获取mysql 容器的id</span><br><span class="line"></span><br><span class="line">docker exec -it 容器id sh</span><br></pre></td></tr></table></figure>
<h1 id="进入Mysql后登录mysql"><a href="#进入Mysql后登录mysql" class="headerlink" title="进入Mysql后登录mysql"></a>进入Mysql后登录mysql</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -proot</span><br><span class="line"></span><br><span class="line">若报root@localhost,请试试mysql -uroot</span><br></pre></td></tr></table></figure>
<h1 id="创建数据库用户"><a href="#创建数据库用户" class="headerlink" title="创建数据库用户"></a>创建数据库用户</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create USER springcloud IDENTIFIED WITH mysql_native_password BY &apos;123456&apos;;</span><br><span class="line"></span><br><span class="line">grant all privileges on *.* to springcloud;</span><br><span class="line"></span><br><span class="line">create database springclouddb</span><br></pre></td></tr></table></figure>
<h1 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h1><p>若show databases 报错<br>若是 缺没有此mysql.infoschema用户<br>则执行以下sql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">create USER &apos;mysql.infoschema&apos; IDENTIFIED WITH mysql_native_password BY &apos;123456&apos;;</span><br><span class="line"></span><br><span class="line">create USER &apos;mysql.session&apos; IDENTIFIED WITH mysql_native_password BY &apos;123456&apos;;</span><br><span class="line"></span><br><span class="line">create USER &apos;mysql.sys&apos;  IDENTIFIED WITH mysql_native_password BY &apos;123456&apos;;</span><br><span class="line"></span><br><span class="line">create USER springcloud IDENTIFIED WITH mysql_native_password BY &apos;123456&apos;;</span><br><span class="line"></span><br><span class="line">grant all privileges on *.* to &apos;mysql.infoschema&apos;;</span><br><span class="line"></span><br><span class="line">grant all privileges on *.* to &apos;mysql.session&apos;;</span><br><span class="line"></span><br><span class="line">grant all privileges on *.* to &apos;mysql.sys&apos;;</span><br></pre></td></tr></table></figure></p>
]]></content>
      
        
        <tags>
            
            <tag> docker </tag>
            
            <tag> mysql </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[（六）docker安装本地仓库（root用户）]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%EF%BC%88%E5%85%AD%EF%BC%89docker%E5%AE%89%E8%A3%85%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%EF%BC%88root%E7%94%A8%E6%88%B7%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>参考：<br><a href="/2018/05/08/（四）安装docker（root用户）/">安装docker</a></p>
<p>创建使用仓库，并设置https 及安全访问</p>
<h1 id="1下载镜像"><a href="#1下载镜像" class="headerlink" title="1下载镜像"></a>1下载镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; docker pull registry</span><br></pre></td></tr></table></figure>
<h1 id="2-创建目录"><a href="#2-创建目录" class="headerlink" title="2 创建目录"></a>2 创建目录</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; mkdir -p ~/certs</span><br></pre></td></tr></table></figure>
<h1 id="3-进入目录"><a href="#3-进入目录" class="headerlink" title="3 进入目录"></a>3 进入目录</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd ~/certs</span><br></pre></td></tr></table></figure>
<h1 id="4-创建域名证书"><a href="#4-创建域名证书" class="headerlink" title="4 创建域名证书"></a>4 创建域名证书</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; keyopenssl genrsa -out rep.itmuch.com.key 2048</span><br></pre></td></tr></table></figure>
<h1 id="5-创建证书"><a href="#5-创建证书" class="headerlink" title="5 创建证书"></a>5 创建证书</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; openssl req -newkey rsa:4096 -nodes -sha256-keyout rep.itmuch.com.key -x509 -days 365 -out rep.itmuch.com.crt  </span><br><span class="line"></span><br><span class="line">Country Name (2 letter code) [XX]:       # 你的国家名称</span><br><span class="line"></span><br><span class="line">CN State or Province Name (full name) []:GD    # 省份</span><br><span class="line"></span><br><span class="line">Locality Name (eg, city) [Default City]:GZ      # 所在城市</span><br><span class="line"></span><br><span class="line">Organization Name (eg, company) [DefaultCompany Ltd]:test     # 组织名称</span><br><span class="line"></span><br><span class="line">Organizational Unit Name (eg, section)[]:test      # 组织单元名称</span><br><span class="line"></span><br><span class="line">Common Name (eg, your name or your server&apos;shostname) []:rep.itmuch.com    # 域名</span><br><span class="line"></span><br><span class="line">Email Address []:     # 邮箱</span><br></pre></td></tr></table></figure>
<h1 id="3-复制证书至docker"><a href="#3-复制证书至docker" class="headerlink" title="3 复制证书至docker"></a>3 复制证书至docker</h1><h2 id="3-1创建目录"><a href="#3-1创建目录" class="headerlink" title="3.1创建目录"></a>3.1创建目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; mkdir -p /etc/docker/certs.d/rep.itmuch.com</span><br></pre></td></tr></table></figure>
<h2 id="3-2-复制证书至docker目录"><a href="#3-2-复制证书至docker目录" class="headerlink" title="3.2 复制证书至docker目录"></a>3.2 复制证书至docker目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; cp ~/certs/rep.itmuch.com.crt/etc/docker/certs.d/rep.itmuch.com/</span><br></pre></td></tr></table></figure>
<h2 id="3-3-重启docker"><a href="#3-3-重启docker" class="headerlink" title="3.3 重启docker"></a>3.3 重启docker</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; systemctl restart docker</span><br></pre></td></tr></table></figure>
<h1 id="4-设置用户名和密码"><a href="#4-设置用户名和密码" class="headerlink" title="4 设置用户名和密码"></a>4 设置用户名和密码</h1><h2 id="4-1-安装-httpd-tools"><a href="#4-1-安装-httpd-tools" class="headerlink" title="4.1 安装 httpd-tools"></a>4.1 安装 httpd-tools</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; yum install httpd-tools</span><br></pre></td></tr></table></figure>
<h2 id="4-2-当前登录用户"><a href="#4-2-当前登录用户" class="headerlink" title="4.2 当前登录用户"></a>4.2 当前登录用户</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; cd~</span><br></pre></td></tr></table></figure>
<h2 id="4-3-创建目录"><a href="#4-3-创建目录" class="headerlink" title="4.3 创建目录"></a>4.3 创建目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;mkdir auth</span><br></pre></td></tr></table></figure>
<h2 id="4-4创建用户名和密码"><a href="#4-4创建用户名和密码" class="headerlink" title="4.4创建用户名和密码"></a>4.4创建用户名和密码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htpasswd-Bbn testuser testpassword &gt; auth/htpasswd</span><br></pre></td></tr></table></figure>
<h2 id="5-运行"><a href="#5-运行" class="headerlink" title="5 运行"></a>5 运行</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">registrydocker run -d -p 443:5000   \-v /root/certs:/certs \ -v/root/auth:/auth \-v /opt/docker-image:/var/lib/registry \-e STORAGE_PATH=/opt/docker-image \-e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/rep.itmuch.com.crt\-e REGISTRY_HTTP_TLS_KEY=/certs/rep.itmuch.com.key\ -e&quot;REGISTRY_AUTH=htpasswd&quot; \  -e&quot;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm&quot; \  -eREGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \registry</span><br></pre></td></tr></table></figure>
<h1 id="host主机名"><a href="#host主机名" class="headerlink" title="host主机名"></a>host主机名</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;192.168.137.8 rep.itmuch.com&apos;&gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure>
<h1 id="登录私有库"><a href="#登录私有库" class="headerlink" title="登录私有库"></a>登录私有库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login rep.itmuch.com</span><br></pre></td></tr></table></figure>
<p>push或pull需要登录否则不能报错</p>
<h1 id="push到私有库"><a href="#push到私有库" class="headerlink" title="push到私有库"></a>push到私有库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker tag alpine rep.itmuch.com/alpine</span><br><span class="line"></span><br><span class="line">docker push rep.itmuch.com/alpine</span><br></pre></td></tr></table></figure>
<h1 id="查看镜像目录"><a href="#查看镜像目录" class="headerlink" title="查看镜像目录"></a>查看镜像目录</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://rep.itmuch.com/v2/_catalog</span><br></pre></td></tr></table></figure>
<h1 id="查看镜像-版本列表"><a href="#查看镜像-版本列表" class="headerlink" title="查看镜像 版本列表"></a>查看镜像 版本列表</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://reg.itmuch.com/v2/alpine/tags/list</span><br></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[（五）更新docker 版本（root用户）]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%EF%BC%89%E6%9B%B4%E6%96%B0docker-%E7%89%88%E6%9C%AC%EF%BC%88root%E7%94%A8%E6%88%B7%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>参考：<a href="/2018/05/08/（四）安装docker（root用户）/">安装docker 操作</a></p>
<h1 id="1-删除旧版本（以下操作都是使用root用户）"><a href="#1-删除旧版本（以下操作都是使用root用户）" class="headerlink" title="1 删除旧版本（以下操作都是使用root用户）"></a>1 删除旧版本（以下操作都是使用root用户）</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line"></span><br><span class="line">docker-client \</span><br><span class="line"></span><br><span class="line">docker-client-latest\ </span><br><span class="line"></span><br><span class="line">docker-common \</span><br><span class="line"></span><br><span class="line">docker-latest \</span><br><span class="line"></span><br><span class="line">docker-latest-logrotate \</span><br><span class="line"></span><br><span class="line">docker-logrotate \</span><br><span class="line"></span><br><span class="line">docker-selinux \</span><br><span class="line"></span><br><span class="line">docker-engine-selinux \</span><br><span class="line"></span><br><span class="line">docker-engine</span><br></pre></td></tr></table></figure>
<h1 id="2-确保docker-ce-edge最新版本"><a href="#2-确保docker-ce-edge最新版本" class="headerlink" title="2 确保docker-ce-edge最新版本"></a>2 确保docker-ce-edge最新版本</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager--enable docker-ce-edge</span><br></pre></td></tr></table></figure>
<h1 id="3-安装docker"><a href="#3-安装docker" class="headerlink" title="3 安装docker"></a>3 安装docker</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker-ce</span><br></pre></td></tr></table></figure>
<h1 id="4-设置集群功能"><a href="#4-设置集群功能" class="headerlink" title="4 设置集群功能"></a>4 设置集群功能</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/systemd/system/multi-user.target.wants/docker.service ExecStart=/usr/bin/dockerd 添加 --experimental=true  表示启用集群功能</span><br></pre></td></tr></table></figure>
<h1 id="5-重新加载配置"><a href="#5-重新加载配置" class="headerlink" title="5 重新加载配置"></a>5 重新加载配置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure>
<h1 id="6-启动服务"><a href="#6-启动服务" class="headerlink" title="6 启动服务"></a>6 启动服务</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctemctl start docker</span><br></pre></td></tr></table></figure>
<h1 id="7-查看版本："><a href="#7-查看版本：" class="headerlink" title="7 查看版本："></a>7 查看版本：</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[（四）安装docker（root用户）]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%EF%BC%88%E5%9B%9B%EF%BC%89%E5%AE%89%E8%A3%85docker%EF%BC%88root%E7%94%A8%E6%88%B7%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>链接：<br><a href="/2018/05/08/）oracle-VM安装red-hat-liunx/">oracle VM安装red hat liunx</a></p>
<p><a href="/2018/05/08/）Red-Hat-升级-rpm软件、YUM软件（root用户）/">升级RPM和YUM 包</a></p>
<h1 id="1-安装docker（以下操作都是使用root用户）"><a href="#1-安装docker（以下操作都是使用root用户）" class="headerlink" title="1 安装docker（以下操作都是使用root用户）"></a>1 安装docker（以下操作都是使用root用户）</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">--安装驱动（red-hat为例,不同操作系统，驱动不同详细看官网教程）</span><br><span class="line">&gt; yum install -y yum-utils device-mapper-persistent-data lvm2  </span><br><span class="line"></span><br><span class="line">--添加docker仓库</span><br><span class="line">&gt; yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"></span><br><span class="line">--清除缓存</span><br><span class="line">&gt; yum clean all</span><br><span class="line"></span><br><span class="line">--重新更新缓存</span><br><span class="line">&gt; yum makecache</span><br><span class="line"></span><br><span class="line">--确保docker engine最新</span><br><span class="line">&gt; yum-config-manager --enable docker-ce-edge</span><br><span class="line"></span><br><span class="line">--安装docker</span><br><span class="line">&gt; yum install docker-ce</span><br><span class="line"></span><br><span class="line">开机启动</span><br><span class="line">&gt; systemctl enable docker</span><br><span class="line"></span><br><span class="line">开启集群权限</span><br><span class="line">&gt;vi /etc/systemd/system/multi-user.target.wants/docker.service ExecStart=/usr/bin/dockerd </span><br><span class="line">添加</span><br><span class="line">--experimental=true </span><br><span class="line"></span><br><span class="line">重新加载配置</span><br><span class="line">&gt;systemctl daemon-reload </span><br><span class="line"></span><br><span class="line"> --启动docker</span><br><span class="line">&gt;systemctl start docker</span><br></pre></td></tr></table></figure>
<p>参考：<a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="noopener">docker官网</a></p>
<p>docker 常用命令 参考<a href="https://docs.docker.com/engine/reference/run/" target="_blank" rel="noopener">docker 命令官网</a></p>
<h1 id="2-查看docker-版本"><a href="#2-查看docker-版本" class="headerlink" title="2 查看docker 版本"></a>2 查看docker 版本</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker version --目前最新版本是 17.12.1-ce</span><br></pre></td></tr></table></figure>
<h1 id="3-查看docker-信息"><a href="#3-查看docker-信息" class="headerlink" title="3 查看docker 信息"></a>3 查看docker 信息</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info</span><br></pre></td></tr></table></figure>
<h1 id="4-运行镜像"><a href="#4-运行镜像" class="headerlink" title="4 运行镜像"></a>4 运行镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-word --本地没有会找镜像库</span><br></pre></td></tr></table></figure>
<p>关于run 一些参数详细参考<a href="https://docs.docker.com/engine/reference/run/" target="_blank" rel="noopener">docker官网</a></p>
<h1 id="5-下载镜像"><a href="#5-下载镜像" class="headerlink" title="5 下载镜像"></a>5 下载镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull alpine</span><br></pre></td></tr></table></figure>
<h1 id="6-制作java环境镜像："><a href="#6-制作java环境镜像：" class="headerlink" title="6 制作java环境镜像："></a>6 制作java环境镜像：</h1><p>使用DockerFile 进行编写 ,参考<a href="https://docs.docker.com/engine/reference/builder/#usage" target="_blank" rel="noopener">dockerFile官网</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">FROM alpine</span><br><span class="line">MAINTAINER killko &lt;killko@qq.com&gt;</span><br><span class="line">ENV TIME_ZONE Asiz/Shanghai</span><br><span class="line">RUN echo &apos;@edge http://nl.alpinelinux.org/alpine/edge/main&apos; &gt;&gt; /etc/apk/repositories &amp;&amp; \</span><br><span class="line">    echo &apos;@community http://nl.alpinelinux.org/alpine/edge/community&apos; &gt;&gt; /etc/apk/repositories &amp;&amp; \</span><br><span class="line">    apk update &amp;&amp; \</span><br><span class="line">    apk upgrade &amp;&amp; \</span><br><span class="line">    apk add ca-certificates openjdk8-jre-base@community &amp;&amp; \</span><br><span class="line">    apk del ca-certificates &amp;&amp; \</span><br><span class="line">    apk add --no-cache tzdata &amp;&amp; \</span><br><span class="line">    echo &quot;$&#123;TIME_ZONE&#125;&quot; &gt; /etc/timezone &amp;&amp; \</span><br><span class="line">    ln -sf /usr/share/zoneinfo/$&#123;TIME_ZONE&#125; /etc/localtime &amp;&amp; \</span><br><span class="line">    rm -rf /tmp/* /var/cache/apk/*</span><br><span class="line">RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai  /etc/localtime</span><br></pre></td></tr></table></figure>
<p>编写完成进行build<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;docker build  -t openjre:latest . --表示在当前目录进行制作镜像</span><br><span class="line">&gt;docker images --查看镜像</span><br><span class="line">&gt;docker run -it openjre sh --进行查看java是否安装成功</span><br></pre></td></tr></table></figure></p>
<h1 id="7-导入镜像"><a href="#7-导入镜像" class="headerlink" title="7 导入镜像"></a>7 导入镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker load &lt; openjre.tar</span><br></pre></td></tr></table></figure>
<h1 id="8-导出镜像："><a href="#8-导出镜像：" class="headerlink" title="8 导出镜像："></a>8 导出镜像：</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save openjre:latest  openjre.tar</span><br></pre></td></tr></table></figure>
<h1 id="9-查看镜像"><a href="#9-查看镜像" class="headerlink" title="9 查看镜像"></a>9 查看镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>
<h1 id="10-查看正在运行容器"><a href="#10-查看正在运行容器" class="headerlink" title="10 查看正在运行容器"></a>10 查看正在运行容器</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a --查看容器id 运行状态 映射端口</span><br></pre></td></tr></table></figure>
<h1 id="11-查看容器日志"><a href="#11-查看容器日志" class="headerlink" title="11 查看容器日志"></a>11 查看容器日志</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f 容器id --容器id从docker ps -a获取</span><br></pre></td></tr></table></figure>
<h1 id="12-停止容器"><a href="#12-停止容器" class="headerlink" title="12 停止容器"></a>12 停止容器</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器id ----容器id从docker ps -a获取</span><br></pre></td></tr></table></figure>
<h1 id="13-删除容器"><a href="#13-删除容器" class="headerlink" title="13 删除容器"></a>13 删除容器</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器id --容器id从docker ps -a获取</span><br></pre></td></tr></table></figure>
<h1 id="14-删除镜像"><a href="#14-删除镜像" class="headerlink" title="14 删除镜像"></a>14 删除镜像</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi imagename:tag --imagename:tag imagename表示镜像名称 tag表示版本 这些信息可以从docker images进行获取</span><br></pre></td></tr></table></figure>
<h1 id="15-进入容器-运行sh命令："><a href="#15-进入容器-运行sh命令：" class="headerlink" title="15 进入容器 运行sh命令："></a>15 进入容器 运行sh命令：</h1><p>docker exec -it 容器id sh –容器id从docker ps -a获取</p>
<h1 id="16-添加普通用户操作docker"><a href="#16-添加普通用户操作docker" class="headerlink" title="16 添加普通用户操作docker"></a>16 添加普通用户操作docker</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vi etc/systemd/system/multi-user.target.wants/docker.service （操作服务）</span><br><span class="line"></span><br><span class="line">ExecStart=/usr/bin/dockerd -G jenkins  #表示jenkins用户组可以操作docker命令</span><br><span class="line"></span><br><span class="line">保存后</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload --重新加载服务</span><br><span class="line"></span><br><span class="line">systemctl restart docker --重启服务</span><br></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> docker </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[（三）linux 安装 GIT（root用户）]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%E4%B8%89%EF%BC%89linux-%E5%AE%89%E8%A3%85-GIT%EF%BC%88root%E7%94%A8%E6%88%B7%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>链接：<br><a href="/2018/05/08/）oracle-VM安装red-hat-liunx/">oracle VM安装red hat liunx</a></p>
<p> <a href="/2018/05/08/）Red-Hat-升级-rpm软件、YUM软件（root用户）/">升级RPM和YUM 包</a></p>
<h1 id="安装GIT（root用户）"><a href="#安装GIT（root用户）" class="headerlink" title="安装GIT（root用户）"></a>安装GIT（root用户）</h1><p>yum install git</p>
<h1 id="1-创建用户"><a href="#1-创建用户" class="headerlink" title="1 创建用户"></a>1 创建用户</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;useradd test</span><br></pre></td></tr></table></figure>
<h1 id="2-设置密码"><a href="#2-设置密码" class="headerlink" title="2 设置密码"></a>2 设置密码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;passwd test</span><br></pre></td></tr></table></figure>
<h1 id="3-创建目录"><a href="#3-创建目录" class="headerlink" title="3 创建目录"></a>3 创建目录</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;mkdir -p /repo</span><br></pre></td></tr></table></figure>
<h1 id="4-初始化git-库"><a href="#4-初始化git-库" class="headerlink" title="4 初始化git 库"></a>4 初始化git 库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;git init --shared /repo/code</span><br></pre></td></tr></table></figure>
<h1 id="5-进入目录："><a href="#5-进入目录：" class="headerlink" title="5 进入目录："></a>5 进入目录：</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;cd /repo/code</span><br></pre></td></tr></table></figure>
<h1 id="6-git-忽略设置"><a href="#6-git-忽略设置" class="headerlink" title="6 git 忽略设置"></a>6 git 忽略设置</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;git config receive.denyCurrentBranch&quot;ignore&quot;</span><br></pre></td></tr></table></figure>
<h1 id="7-设置-邮件"><a href="#7-设置-邮件" class="headerlink" title="7 设置 邮件"></a>7 设置 邮件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;git config --global user.email  123@126.com</span><br></pre></td></tr></table></figure>
<h1 id="8-设置-用户名"><a href="#8-设置-用户名" class="headerlink" title="8 设置 用户名"></a>8 设置 用户名</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;git config --global user.name &quot;test&quot;</span><br></pre></td></tr></table></figure>
<h1 id="9-添加README-md"><a href="#9-添加README-md" class="headerlink" title="9 添加README.md"></a>9 添加README.md</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;touch ./Readme.md</span><br></pre></td></tr></table></figure>
<h1 id="10-git-add文件"><a href="#10-git-add文件" class="headerlink" title="10 git add文件"></a>10 git add文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;git add ./Readme.md</span><br></pre></td></tr></table></figure>
<h1 id="11-提交代码"><a href="#11-提交代码" class="headerlink" title="11 提交代码"></a>11 提交代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;git commit -m &quot;init&quot;./Readme.md</span><br></pre></td></tr></table></figure>
<h1 id="12-设置权限"><a href="#12-设置权限" class="headerlink" title="12 设置权限"></a>12 设置权限</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; chmod -R og+w /repoE</span><br></pre></td></tr></table></figure>
<h1 id="13-下载代码"><a href="#13-下载代码" class="headerlink" title="13 下载代码"></a>13 下载代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone ssh://test@192.168.137.8/repo/code</span><br></pre></td></tr></table></figure>
<h1 id="14-添加文件"><a href="#14-添加文件" class="headerlink" title="14 添加文件"></a>14 添加文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add</span><br></pre></td></tr></table></figure>
<h1 id="15-提交文件"><a href="#15-提交文件" class="headerlink" title="15 提交文件"></a>15 提交文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit</span><br></pre></td></tr></table></figure>
<h1 id="16-推送代码"><a href="#16-推送代码" class="headerlink" title="16 推送代码"></a>16 推送代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure>]]></content>
      
        <categories>
            
            <category> git </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[(二）Red-Hat-升级-rpm软件、YUM软件（root用户）]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/Red-Hat-%E5%8D%87%E7%BA%A7-rpm%E8%BD%AF%E4%BB%B6%E3%80%81YUM%E8%BD%AF%E4%BB%B6%EF%BC%88root%E7%94%A8%E6%88%B7%EF%BC%89/</url>
      <content type="html"><![CDATA[<p>以下操作是root用户</p>
<p>1 <a href="/2018/05/08/）oracle-VM安装red-hat-liunx/">oracle VM安装red hat liunx</a></p>
<p>rpm 下载链接：<a href="http://mirrors.163.com/centos/7/os/x86_64/Packages/" target="_blank" rel="noopener">http://mirrors.163.com/centos/7/os/x86_64/Packages/</a></p>
<h1 id="查看版本"><a href="#查看版本" class="headerlink" title="查看版本"></a>查看版本</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; rpm version</span><br></pre></td></tr></table></figure>
<p><img src="/2018/05/08/Red-Hat-升级-rpm软件、YUM软件（root用户）/11278290-76fc51b36f51535f.png" alt="logo"></p>
<h1 id="升级rpm"><a href="#升级rpm" class="headerlink" title="升级rpm"></a>升级rpm</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;rpm -Uvh rpm-4.11.3-25.el7.x86_64.rpm  rpm-build-libs-4.11.3-25.el7.x86_64.rpm rpm-libs-4.11.3-25.el7.x86_64.rpm rpm-python-4.11.3-25.el7.x86_64.rpm --force -i</span><br></pre></td></tr></table></figure>
<p><img src="/2018/05/08/Red-Hat-升级-rpm软件、YUM软件（root用户）/11278290-2b0c840c69622e92.png" alt="logo"></p>
<h1 id="删除旧的yum"><a href="#删除旧的yum" class="headerlink" title="删除旧的yum"></a>删除旧的yum</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; rpm -e yum-metadata-parser-1.1.4-10.el7.x86_64 yum-3.4.3-125.el7.noarch yum-rhn-plugin-2.0.1-5.el7.noarch --nodeps</span><br></pre></td></tr></table></figure>
<h1 id="安装yum"><a href="#安装yum" class="headerlink" title="安装yum"></a>安装yum</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; rpm -Uvh yum-3.4.3-154.el7.centos.noarch.rpm yum-metadata-parser-1.1.4-10.el7.x86_64.rpm python-urlgrabber-3.10-8.el7.noarch.rpm yum-plugin-fastestmirror-1.1.31-42.el7.noarch.rpm yum-utils-1.1.31-42.el7.noarch.rpm  python-kitchen-1.1.1-5.el7.noarch.rpm python-chardet-2.2.1-1.el7_1.noarch.rpm</span><br></pre></td></tr></table></figure>
<h1 id="编辑-CentOS6-Base-repo"><a href="#编辑-CentOS6-Base-repo" class="headerlink" title="编辑 CentOS6-Base.repo"></a>编辑 CentOS6-Base.repo</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi CentOS6-Base.repo 文件</span><br></pre></td></tr></table></figure>
<h1 id="CentOS-Base-repo"><a href="#CentOS-Base-repo" class="headerlink" title="CentOS-Base.repo"></a>CentOS-Base.repo</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"># CentOS-Base.repo</span><br><span class="line">#</span><br><span class="line"># The mirror system uses the connecting IP address of the client and the</span><br><span class="line"># update status of each mirror to pick mirrors that are updated to and</span><br><span class="line"># geographically close to the client.  You should use this for CentOS updates</span><br><span class="line"># unless you are manually picking other mirrors.</span><br><span class="line">#</span><br><span class="line"># If the mirrorlist= does not work for you, as a fall back you can try the </span><br><span class="line"># remarked out baseurl= line instead.</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"> </span><br><span class="line">[base]</span><br><span class="line">name=CentOS-7 - Base - mirrors.aliyun.com</span><br><span class="line">failovermethod=priority</span><br><span class="line">baseurl=http://mirrors.aliyun.com/centos/7/os/$basearch/</span><br><span class="line">        http://mirrors.aliyuncs.com/centos/7/os/$basearch/</span><br><span class="line">#mirrorlist=http://mirrorlist.centos.org/?release=7&amp;arch=$basearch&amp;repo=os</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line"> </span><br><span class="line">#released updates </span><br><span class="line">[updates]</span><br><span class="line">name=CentOS-7 - Updates - mirrors.aliyun.com</span><br><span class="line">failovermethod=priority</span><br><span class="line">baseurl=http://mirrors.aliyun.com/centos/7/updates/$basearch/</span><br><span class="line">        http://mirrors.aliyuncs.com/centos/7/updates/$basearch/</span><br><span class="line">#mirrorlist=http://mirrorlist.centos.org/?release=7&amp;arch=$basearch&amp;repo=updates</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line"> </span><br><span class="line">#additional packages that may be useful</span><br><span class="line">[extras]</span><br><span class="line">name=CentOS-7 - Extras - mirrors.aliyun.com</span><br><span class="line">failovermethod=priority</span><br><span class="line">baseurl=http://mirrors.aliyun.com/centos/7/extras/$basearch/</span><br><span class="line">        http://mirrors.aliyuncs.com/centos/7/extras/$basearch/</span><br><span class="line">#mirrorlist=http://mirrorlist.centos.org/?release=7&amp;arch=$basearch&amp;repo=extras</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line"> </span><br><span class="line">#additional packages that extend functionality of existing packages</span><br><span class="line">[centosplus]</span><br><span class="line">name=CentOS-7 - Plus - mirrors.aliyun.com</span><br><span class="line">failovermethod=priority</span><br><span class="line">baseurl=http://mirrors.aliyun.com/centos/7/centosplus/$basearch/</span><br><span class="line">        http://mirrors.aliyuncs.com/centos/7/centosplus/$basearch/</span><br><span class="line">#mirrorlist=http://mirrorlist.centos.org/?release=7&amp;arch=$basearch&amp;repo=centosplus</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line"> </span><br><span class="line">#contrib - packages by Centos Users</span><br><span class="line">[contrib]</span><br><span class="line">name=CentOS-7 - Contrib - mirrors.aliyun.com</span><br><span class="line">failovermethod=priority</span><br><span class="line">baseurl=http://mirrors.aliyun.com/centos/7/contrib/$basearch/</span><br><span class="line">        http://mirrors.aliyuncs.com/centos/7/contrib/$basearch/</span><br><span class="line">#mirrorlist=http://mirrorlist.centos.org/?release=7&amp;arch=$basearch&amp;repo=contrib</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span><br></pre></td></tr></table></figure>
<h1 id="复制资源库文件至yum目录"><a href="#复制资源库文件至yum目录" class="headerlink" title="复制资源库文件至yum目录"></a>复制资源库文件至yum目录</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; cp CentOS6-Base.repo /etc/yum.repos.d/</span><br></pre></td></tr></table></figure>
<h1 id="清除缓存"><a href="#清除缓存" class="headerlink" title="清除缓存"></a>清除缓存</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;yum clean all</span><br></pre></td></tr></table></figure>
<h1 id="建立yum-缓存"><a href="#建立yum-缓存" class="headerlink" title="建立yum 缓存"></a>建立yum 缓存</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;yum makecache</span><br></pre></td></tr></table></figure>
<p><img src="/2018/05/08/Red-Hat-升级-rpm软件、YUM软件（root用户）/11278290-d31d27becb290491.png" alt="logo"></p>
<h1 id="再次更新yum"><a href="#再次更新yum" class="headerlink" title="再次更新yum"></a>再次更新yum</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update yum</span><br></pre></td></tr></table></figure>
<p>yum install yum-rhn*</p>
<p>yum update redhat*</p>
]]></content>
      
        <categories>
            
            <category> linux </category>
            
        </categories>
        
        
        <tags>
            
            <tag> linux </tag>
            
            <tag> rpm </tag>
            
            <tag> yum </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[（一）oracle VM安装red hat liunx]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%EF%BC%89oracle-VM%E5%AE%89%E8%A3%85red-hat-liunx/</url>
      <content type="html"><![CDATA[<p>软件：Oracle VM VirtualBox</p>
<p>网络桥接物流网卡：</p>
<h1 id="1打开Oracle-VMVirtualBox-点击新建按钮"><a href="#1打开Oracle-VMVirtualBox-点击新建按钮" class="headerlink" title="1打开Oracle VMVirtualBox 点击新建按钮"></a>1打开Oracle VMVirtualBox 点击新建按钮</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-8cae3ccf049eb036.png" alt="logo"></p>
<h1 id="2-点击-下一步-按钮"><a href="#2-点击-下一步-按钮" class="headerlink" title="2 点击 下一步 按钮"></a>2 点击 下一步 按钮</h1><p>名称 输入：jenkins</p>
<p>类型：Linux</p>
<p>操作系统：Red Rat(64 bit)<br><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-d23c40773d84371f.png" alt="logo"></p>
<h1 id="3-内存-默认1G，点击-下一步"><a href="#3-内存-默认1G，点击-下一步" class="headerlink" title="3 内存 默认1G，点击 下一步"></a>3 内存 默认1G，点击 下一步</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-22f082cba471a8bb.png" alt="logo"></p>
<h1 id="4-选择-现在创建虚拟硬盘-，点击-创建-按钮"><a href="#4-选择-现在创建虚拟硬盘-，点击-创建-按钮" class="headerlink" title="4 选择 现在创建虚拟硬盘 ，点击 创建 按钮"></a>4 选择 现在创建虚拟硬盘 ，点击 创建 按钮</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-6a1302edff3ebf2e.png" alt="logo"></p>
<h1 id="5-默认选项，点击-下一步"><a href="#5-默认选项，点击-下一步" class="headerlink" title="5 默认选项，点击 下一步"></a>5 默认选项，点击 下一步</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-8baeb9eb905c71a2.png" alt="logo"></p>
<h1 id="6-选择-动态分配-，点击-下一步-按钮"><a href="#6-选择-动态分配-，点击-下一步-按钮" class="headerlink" title="6 选择 动态分配 ，点击 下一步 按钮"></a>6 选择 动态分配 ，点击 下一步 按钮</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-7adf8cc44c0ee846.png" alt="logo"></p>
<h1 id="7-设置硬盘大小-40G-，后点击创建按钮"><a href="#7-设置硬盘大小-40G-，后点击创建按钮" class="headerlink" title="7  设置硬盘大小:40G ，后点击创建按钮"></a>7  设置硬盘大小:40G ，后点击创建按钮</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-4e335970ba06000f.png" alt="logo"></p>
<h1 id="8-点击设置按钮"><a href="#8-点击设置按钮" class="headerlink" title="8 点击设置按钮"></a>8 点击设置按钮</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-f9a8280cb4192f6b.png" alt="logo"></p>
<h1 id="9-选择-网卡-选项，选择-桥接网卡-方式，选择存储选项"><a href="#9-选择-网卡-选项，选择-桥接网卡-方式，选择存储选项" class="headerlink" title="9 选择 网卡 选项，选择 桥接网卡 方式，选择存储选项"></a>9 选择 网卡 选项，选择 桥接网卡 方式，选择存储选项</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-24e0f2beb6f3331e.png" alt="logo"></p>
<h1 id="10-进行选择ISO镜像，点击图中-红色部分"><a href="#10-进行选择ISO镜像，点击图中-红色部分" class="headerlink" title="10 进行选择ISO镜像，点击图中 红色部分"></a>10 进行选择ISO镜像，点击图中 红色部分</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-0322ebd8568ed1e0.png" alt="logo"></p>
<h1 id="11-点击选择-磁盘"><a href="#11-点击选择-磁盘" class="headerlink" title="11 点击选择 磁盘"></a>11 点击选择 磁盘</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-82234f6e704f75f6.png" alt="logo"></p>
<h1 id="12-在弹出窗口-选择-系统镜像，选择完成-，点击打开按钮镜像可以从https-www-linuxprobe-com-tools下载"><a href="#12-在弹出窗口-选择-系统镜像，选择完成-，点击打开按钮镜像可以从https-www-linuxprobe-com-tools下载" class="headerlink" title="12 在弹出窗口 选择 系统镜像，选择完成 ，点击打开按钮镜像可以从https://www.linuxprobe.com/tools下载"></a>12 在弹出窗口 选择 系统镜像，选择完成 ，点击打开按钮镜像可以从<a href="https://www.linuxprobe.com/tools下载" target="_blank" rel="noopener">https://www.linuxprobe.com/tools下载</a></h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-e8c8a52d140c5609.png" alt="logo"></p>
<h1 id="13-点击OK-按钮后"><a href="#13-点击OK-按钮后" class="headerlink" title="13 点击OK 按钮后"></a>13 点击OK 按钮后</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-e22e0734301c33b6.png" alt="logo"></p>
<h1 id="14-虚拟机设置完成，点击启动"><a href="#14-虚拟机设置完成，点击启动" class="headerlink" title="14 虚拟机设置完成，点击启动"></a>14 虚拟机设置完成，点击启动</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-23e3a150c783f9fb.png" alt="logo"></p>
<h1 id="15-点击-启动按钮-选择InstallRed-Hat-Enterprise-Linux-7-1–-gt-enter"><a href="#15-点击-启动按钮-选择InstallRed-Hat-Enterprise-Linux-7-1–-gt-enter" class="headerlink" title="15 点击 启动按钮,选择InstallRed Hat Enterprise Linux 7.1–&gt;enter"></a>15 点击 启动按钮,选择InstallRed Hat Enterprise Linux 7.1–&gt;enter</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-b20d2391b41df6dc.png" alt="logo"></p>
<h1 id="16-选择语言-界面-，点击continue"><a href="#16-选择语言-界面-，点击continue" class="headerlink" title="16 选择语言 界面 ，点击continue"></a>16 选择语言 界面 ，点击continue</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-fe5bdba62c19c919.png" alt="logo"></p>
<h1 id="17-点击network-amp-host-name"><a href="#17-点击network-amp-host-name" class="headerlink" title="17 点击network&amp; host name"></a>17 点击network&amp; host name</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-77b646357a8b5e8a.png" alt="logo"></p>
<h1 id="18-OFF-改为ON后，点击DONE"><a href="#18-OFF-改为ON后，点击DONE" class="headerlink" title="18 OFF 改为ON后，点击DONE"></a>18 OFF 改为ON后，点击DONE</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-5bc80879edb2e0d6.png" alt="logo"></p>
<p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-cd397c4737115c39.png" alt="logo"></p>
<h1 id="19-选择INSTALLATIONDESTINATION"><a href="#19-选择INSTALLATIONDESTINATION" class="headerlink" title="19 选择INSTALLATIONDESTINATION"></a>19 选择INSTALLATIONDESTINATION</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-dc140d95517fb4de.png" alt="logo"></p>
<h1 id="20-点击Done-默认设置"><a href="#20-点击Done-默认设置" class="headerlink" title="20 点击Done,默认设置"></a>20 点击Done,默认设置</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-44f8decd9c26bb76.png" alt="logo"></p>
<h1 id="21-点击DATE-amp-TIME"><a href="#21-点击DATE-amp-TIME" class="headerlink" title="21 点击DATE&amp;TIME"></a>21 点击DATE&amp;TIME</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-62b4d6ecfa01455b.png" alt="logo"></p>
<h1 id="22-Region-改为Asia-City-上海，networkTime-ON，后点击Done"><a href="#22-Region-改为Asia-City-上海，networkTime-ON，后点击Done" class="headerlink" title="22 Region 改为Asia ,City:上海，networkTime=ON，后点击Done"></a>22 Region 改为Asia ,City:上海，networkTime=ON，后点击Done</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-5b08e271ee6f5d60.png" alt="logo"><br><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-f36a34e0fbdd4dbf.png" alt="logo"></p>
<h1 id="23-点击BeginInstallation"><a href="#23-点击BeginInstallation" class="headerlink" title="23 点击BeginInstallation"></a>23 点击BeginInstallation</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-a75186d85c19ec0b.png" alt="logo"></p>
<h1 id="24-点击ROOT-PASSWORD-进行设置ROOT-密码"><a href="#24-点击ROOT-PASSWORD-进行设置ROOT-密码" class="headerlink" title="24 点击ROOT PASSWORD 进行设置ROOT 密码"></a>24 点击ROOT PASSWORD 进行设置ROOT 密码</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-26a6a241112a9517.png" alt="logo"></p>
<h1 id="25-输入ROOT-密码点击Done"><a href="#25-输入ROOT-密码点击Done" class="headerlink" title="25 输入ROOT 密码点击Done"></a>25 输入ROOT 密码点击Done</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-7a2a749fed3fa8f9.png" alt="logo"></p>
<h1 id="26-耐心等候安装完成-如下图，点击REBOOT"><a href="#26-耐心等候安装完成-如下图，点击REBOOT" class="headerlink" title="26 耐心等候安装完成 如下图，点击REBOOT"></a>26 耐心等候安装完成 如下图，点击REBOOT</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-1df5c789751f5083.png" alt="logo"></p>
<h1 id="27-重启完成，如下图，表示安装成功，使用ROOT用户进行登录"><a href="#27-重启完成，如下图，表示安装成功，使用ROOT用户进行登录" class="headerlink" title="27 重启完成，如下图，表示安装成功，使用ROOT用户进行登录"></a>27 重启完成，如下图，表示安装成功，使用ROOT用户进行登录</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-1edb28581c216a0d.png" alt="logo"></p>
<h1 id="28-输入ip-addr-查看当前虚拟机的ip"><a href="#28-输入ip-addr-查看当前虚拟机的ip" class="headerlink" title="28 输入ip addr 查看当前虚拟机的ip"></a>28 输入ip addr 查看当前虚拟机的ip</h1><p>正常：</p>
<p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-92aec236bf64d15a.png" alt="logo"></p>
<p>不正常：<br><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-105894cde675332f.png" alt="logo"></p>
<p>解决办法：</p>
<p> cd/etc/sysconfig/network-scripts/</p>
<p>打开网卡文件进行设置静态IP vi ifcfg-enp0s3</p>
<p>首先把BOOTPROTO=”dhcp”改成BOOTPROTO=”static”表示静态获取，</p>
<p>然后在最后追加比如下面的配置：</p>
<p>IPADDR=192.168.1.33</p>
<p>NETMASK=255.255.255.0</p>
<p>GATEWAY=192.168.1.1</p>
<p>DNS1=202.96.134.33</p>
<p>保存后，</p>
<p>运行systemctl restart network</p>
<p>再次查看ip addr<br><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-cc3760aa781c68ef.png" alt="logo"></p>
<h1 id="29-使用SecureCRT-进行连接虚拟机"><a href="#29-使用SecureCRT-进行连接虚拟机" class="headerlink" title="29 使用SecureCRT 进行连接虚拟机"></a>29 使用SecureCRT 进行连接虚拟机</h1><p><img src="/2018/05/08/）oracle-VM安装red-hat-liunx/11278290-01decabbbeebf0d4.png" alt="logo"></p>
]]></content>
      
        
        <tags>
            
            <tag> red hat Linux </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[thymeleaf学习的坑]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/hymeleaf%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%9D%91/</url>
      <content type="html"><![CDATA[<h1 id="引入css和js文件"><a href="#引入css和js文件" class="headerlink" title="引入css和js文件"></a>引入css和js文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;link th:href=&quot;@&#123;/resources/admin/css/common.css&#125;&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;</span><br><span class="line">&lt;script  type=&quot;text/javascript&quot; th:src=&quot;@&#123;/resources/admin/js/jquery.js&#125;&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h1 id="网页标题-多语言"><a href="#网页标题-多语言" class="headerlink" title="网页标题(多语言)"></a>网页标题(多语言)</h1><p>使用#{key}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  &lt;title th:text=&quot;#&#123;system.name&#125;&quot;&gt;&lt;/title&gt;</span><br><span class="line"># thymeleaf结合js</span><br><span class="line">&lt;script  th:inline=&quot;javascript&quot;&gt;</span><br><span class="line">       //controller 使用Model设置属性</span><br><span class="line">         var error=[[$&#123;error&#125;]];</span><br><span class="line">       //多语言</span><br><span class="line">       var usernameRequired=[[#&#123;admin.login.usernameRequired&#125;]]</span><br><span class="line">    &lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="thymeleaf结合js-冲突"><a href="#thymeleaf结合js-冲突" class="headerlink" title="thymeleaf结合js 冲突"></a>thymeleaf结合js 冲突</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//使用&lt;![CDATA[ ]]&gt;</span><br><span class="line">&lt;script th:inline=&quot;javascript&quot;&gt;</span><br><span class="line">//&lt;![CDATA[</span><br><span class="line">  js code</span><br><span class="line">	// ]]&gt;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h1 id="th-include"><a href="#th-include" class="headerlink" title="th:include"></a>th:include</h1><p>compontent/commonJs.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div th:fragment=&quot;commonJs&quot;&gt;</span><br><span class="line">&lt;script th:inline=&quot;javascript&quot;&gt;</span><br><span class="line">js代码（国际化语言）</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>引用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div th:include=&quot;compontent/commonJs::commonJs&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="th-href"><a href="#th-href" class="headerlink" title="th:href"></a>th:href</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a th:href=&quot;@&#123;/admin/publicInfo/info(id=$&#123;publicInfo.id&#125;)&#125;&quot; target=&quot;iframe&quot; th:text=&quot;#&#123;admin.menu.publicManage.name&#125;&quot;&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure>
<h1 id="th-each"><a href="#th-each" class="headerlink" title="th:each"></a>th:each</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;tr th:each=&quot;admin:$&#123;page.content&#125;&quot;&gt;</span><br><span class="line">			  &lt;td th:text=&quot;$&#123;admin.username&#125;&quot;&gt;&lt;/td&gt;</span><br><span class="line">	      &lt;/tr&gt;</span><br></pre></td></tr></table></figure>
<h1 id="格式化日期"><a href="#格式化日期" class="headerlink" title="格式化日期"></a>格式化日期</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;td th:text=&quot;$&#123;#calendars.format(admin.createDate,&apos;yyyy年MM月dd日&apos;)&#125;&quot;&gt;&lt;/td&gt;</span><br></pre></td></tr></table></figure>
<h1 id="th-if"><a href="#th-if" class="headerlink" title="th:if"></a>th:if</h1><p>•    单个条件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;td th:if=&quot;$&#123;admin.username&#125;==&apos;admin&apos;&quot;&gt;&lt;input type=&quot;checkbox&quot; name=&quot;ids&quot; th:value=&quot;$&#123;admin.id&#125;&quot; disabled=&quot;disabled&quot;/&gt;&lt;/td&gt;</span><br></pre></td></tr></table></figure></p>
<p>•    并且条件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;td th:if=&quot;$&#123;session.username&#125;!=&apos;admin&apos; and $&#123;admin.username&#125;==$&#123;session.username&#125;&quot;&gt;</span><br><span class="line">&lt;a th:href=&quot;@&#123;initEdit(id=$&#123;admin.id&#125;)&#125;&quot; th:text=&quot;#&#123;admin.menu.admin.edit&#125;&quot;&gt;</span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&lt;/td&gt;</span><br></pre></td></tr></table></figure></p>
]]></content>
      
        
        <tags>
            
            <tag> thymeleaf </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[那些提升开发人员工作效率的在线工具]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%E9%82%A3%E4%BA%9B%E6%8F%90%E5%8D%87%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87%E7%9A%84%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7/</url>
      <content type="html"><![CDATA[<p>作为一个Java开发人员，经常要和各种各样的工具打交道，除了我们常用的IDE工具以外，其实还有很多工具是我们在日常开发及学习过程中要经常使用到的。</p>
<p>Hollis偏爱使用在线工具，因为个人觉得这样比较方便。本文就总结了一下我常用的在线工具。欢迎纠正及补充。</p>
<h1 id="Java源代码搜索"><a href="#Java源代码搜索" class="headerlink" title="Java源代码搜索"></a>Java源代码搜索</h1><p><a href="http://grepcode.com/" target="_blank" rel="noopener">http://grepcode.com/</a></p>
<p>Grepcode是一个面向于Java开发人员的网站，在这里你可以通过Java的projects、classes等各种关键字在线查看它对应的源码，知道对应的project、classes等信息。 更方便的是，能提供非常多不同版本的源码在线查看、jar包、源码jar包、doc的下载。 同样，你也可以之间使用xxx-1.1.1.jar类似这样的名字直接找到对应的jar包，从而下载。</p>
<h1 id="开源代码及文档搜索"><a href="#开源代码及文档搜索" class="headerlink" title="开源代码及文档搜索"></a>开源代码及文档搜索</h1><p><a href="https://searchcode.com/" target="_blank" rel="noopener">https://searchcode.com/</a></p>
<p>SearchCode 是一个源码搜索引擎，目前支持从 Github、Bitbucket、Google Code、CodePlex、SourceForge 和 Fedora Project 平台搜索公开的源码。</p>
<h1 id="电子书搜索"><a href="#电子书搜索" class="headerlink" title="电子书搜索"></a>电子书搜索</h1><p><a href="https://www.jiumodiary.com/" target="_blank" rel="noopener">https://www.jiumodiary.com/</a></p>
<p>鸠摩搜书是一个比较不错的电子书搜索网站。内容也比较全。</p>
<h1 id="网盘资源搜索"><a href="#网盘资源搜索" class="headerlink" title="网盘资源搜索"></a>网盘资源搜索</h1><p><a href="http://pansou.com/" target="_blank" rel="noopener">http://pansou.com/</a></p>
<p>这个大家都懂的，可以通过这个网站搜索百度网盘上面的各种资源。</p>
<h1 id="无版权图片搜索"><a href="#无版权图片搜索" class="headerlink" title="无版权图片搜索"></a>无版权图片搜索</h1><p><a href="https://unsplash.com" target="_blank" rel="noopener">https://unsplash.com</a></p>
<p>不知道有没有人和我一样，经常需要一些无版权的图片，比如公众号配图。</p>
<p>unsplash是我用过的最好的网站，不需要登录，图片很高请，也比较全。唯一的缺点就是需要英文搜搜。</p>
<h1 id="在线UML制图"><a href="#在线UML制图" class="headerlink" title="在线UML制图"></a>在线UML制图</h1><p><a href="https://www.processon.com/" target="_blank" rel="noopener">https://www.processon.com/</a></p>
<p>ProcessOn是一个在线协作绘图平台，为用户提供最强大、易用的作图工具!支持在线创作流程图、BPMN、UML图、UI界面原型设计、iOS界面原型设计等。</p>
<h1 id="Json在线验证及格式化"><a href="#Json在线验证及格式化" class="headerlink" title="Json在线验证及格式化"></a>Json在线验证及格式化</h1><p><a href="https://www.json.cn/" target="_blank" rel="noopener">https://www.json.cn/</a></p>
<p>我用过很多json在线格式化的工具，经过实践，json.cn是比较不错的，不仅支持json格式的验证及格式化，还可以将json格式压缩成普通文本等好用功能。</p>
<p>Diff Check<br><a href="https://www.diffchecker.com/" target="_blank" rel="noopener">https://www.diffchecker.com/</a></p>
<p>使用过svn或者git的人对diffcheck肯定不陌生，但有时候我们修改的文本内容并没有被版本控制，那么就可以使用在线的网站查看文件的修改情况。diffchecker很不错。</p>
<h1 id="MarkDown编辑器"><a href="#MarkDown编辑器" class="headerlink" title="MarkDown编辑器"></a>MarkDown编辑器</h1><p>MaHua ：<a href="http://mahua.jser.me/" target="_blank" rel="noopener">http://mahua.jser.me/</a></p>
<p>马克飞象 ：<a href="https://maxiang.io/" target="_blank" rel="noopener">https://maxiang.io/</a></p>
<p>Cmd ：<a href="https://www.zybuluo.com/mdeditor" target="_blank" rel="noopener">https://www.zybuluo.com/mdeditor</a></p>
<p>以上这几个我都用过，都还好吧，因为我一般都喜欢把自己写过的东西保存下来，所以就用了客户端的，我是用的是MacDown</p>
<h1 id="Maven依赖查询"><a href="#Maven依赖查询" class="headerlink" title="Maven依赖查询"></a>Maven依赖查询</h1><p><a href="http://mvnrepository.com/" target="_blank" rel="noopener">http://mvnrepository.com/</a></p>
<p>mvnrepository这个不用详细解释了，就是查询maven的gav信息一类的。因为我们公司有内部的Nexus仓库，所以很少用这个。</p>
<h1 id="在线代码运行"><a href="#在线代码运行" class="headerlink" title="在线代码运行"></a>在线代码运行</h1><p><a href="https://tool.lu/coderunner/" target="_blank" rel="noopener">https://tool.lu/coderunner/</a></p>
<p>coderunner可以在线运行php,c,c++,go,python,java,groovy等代码。当我们在外面，没有IDE又想执行个小程序的时候是个不错的选择。</p>
<h1 id="在线翻译"><a href="#在线翻译" class="headerlink" title="在线翻译"></a>在线翻译</h1><p>Google翻译 ：<a href="https://translate.google.cn/" target="_blank" rel="noopener">https://translate.google.cn/</a></p>
<p>百度翻译 ：<a href="http://fanyi.baidu.com/" target="_blank" rel="noopener">http://fanyi.baidu.com/</a></p>
<p>有道翻译 ：<a href="http://fanyi.youdao.com/" target="_blank" rel="noopener">http://fanyi.youdao.com/</a></p>
<p>说不出具体哪个好，其实都不太准确，还是需要自己根据语境进行翻译。</p>
<p>不过忍不住吐槽一句国内的这几个翻译网站，既然是做翻译的，域名竟然用拼音，我也是醉了。</p>
<h1 id="SQL自动生成Java代码"><a href="#SQL自动生成Java代码" class="headerlink" title="SQL自动生成Java代码"></a>SQL自动生成Java代码</h1><p><a href="http://www.autojcode.com/code/sql2class.jsp" target="_blank" rel="noopener">http://www.autojcode.com/code/sql2class.jsp</a></p>
<p>AutoJCode可以从sql的建表语句中生成一个DO类。</p>
<h1 id="json生成java类"><a href="#json生成java类" class="headerlink" title="json生成java类"></a>json生成java类</h1><p><a href="http://www.bejson.com/json2javapojo" target="_blank" rel="noopener">http://www.bejson.com/json2javapojo</a></p>
<p>json是目前JavaWeb中数据传输的主要格式，很多时候会有把json转成Java对象的需求。有时候合作方会提供一个json的样例，需要我们自己定义Java类，这时候这个工具就派上用场了。</p>
<h1 id="SQL美化-格式化-压缩"><a href="#SQL美化-格式化-压缩" class="headerlink" title="SQL美化/格式化/压缩"></a>SQL美化/格式化/压缩</h1><p><a href="https://tool.lu/sql/" target="_blank" rel="noopener">https://tool.lu/sql/</a></p>
<p>sql在线美化，格式化，压缩：</p>
<h1 id="编码转换"><a href="#编码转换" class="headerlink" title="编码转换"></a>编码转换</h1><p><a href="http://tool.chinaz.com/tools/unicode.aspx" target="_blank" rel="noopener">http://tool.chinaz.com/tools/unicode.aspx</a></p>
<p>站长工具的编码转换比较全面，提供了Unicode编码、UFT8编码、URL编码/解码等功能。</p>
<h1 id="Corn表达式生成"><a href="#Corn表达式生成" class="headerlink" title="Corn表达式生成"></a>Corn表达式生成</h1><p><a href="http://www.pdtools.net/tools/becron.jsp" target="_blank" rel="noopener">http://www.pdtools.net/tools/becron.jsp</a></p>
<p>Cron 一般用于配置定时任务的执行。</p>
<h1 id="正则验证"><a href="#正则验证" class="headerlink" title="正则验证"></a>正则验证</h1><p><a href="http://tool.chinaz.com/regex" target="_blank" rel="noopener">http://tool.chinaz.com/regex</a></p>
<p>Java开发对正则表达式肯定不陌生。站长工具提供的正则验证还不错。</p>
<h1 id="正则代码生成"><a href="#正则代码生成" class="headerlink" title="正则代码生成"></a>正则代码生成</h1><p><a href="http://tool.chinaz.com/tools/regexgenerate" target="_blank" rel="noopener">http://tool.chinaz.com/tools/regexgenerate</a></p>
<p>站长工具提供的正则代码生成。可以一键生成身份证号、邮箱、手机号等验证的正则表达式。</p>
<h1 id="时间戳转换"><a href="#时间戳转换" class="headerlink" title="时间戳转换"></a>时间戳转换</h1><p><a href="http://tool.chinaz.com/Tools/unixtime.aspx" target="_blank" rel="noopener">http://tool.chinaz.com/Tools/unixtime.aspx</a></p>
<p>时间戳(英语：Timestamp）是指在一连串的资料中加入辨识文字，如时间或日期，用以保障本地端（local）资料更新顺序与远端（remote）一致。</p>
<p>Java中很多地方都会用到时间戳，也经常会使用这种转换工具。</p>
<h1 id="世界时间转换"><a href="#世界时间转换" class="headerlink" title="世界时间转换"></a>世界时间转换</h1><p><a href="http://www.timebie.com/cn/easternbeijing.php" target="_blank" rel="noopener">http://www.timebie.com/cn/easternbeijing.php</a></p>
<p>世界各地时间转换，我之前做国际业务的时候，比较常用的是北京时间转纽约时间，北京时间转洛杉矶时间。 timebie提供了世界时间相互转换的功能。</p>
<h1 id="加密解密"><a href="#加密解密" class="headerlink" title="加密解密"></a>加密解密</h1><p><a href="http://tool.chinaz.com/tools/textencrypt.aspx" target="_blank" rel="noopener">http://tool.chinaz.com/tools/textencrypt.aspx</a></p>
<p>加密解密也是JavaWeb可能会经常遇到的，有的时候我们需要验证加密算法是否正确，或者要解密等场景，就需要一个在线工具。</p>
<h1 id="查看网页源代码"><a href="#查看网页源代码" class="headerlink" title="查看网页源代码"></a>查看网页源代码</h1><p><a href="http://s.tool.chinaz.com/tools/pagecode.aspx" target="_blank" rel="noopener">http://s.tool.chinaz.com/tools/pagecode.aspx</a></p>
<p>这个工具，可以输入一个网站，直接查看网站的源码。具体有什么用，大家可以发挥各种想象。</p>
<h1 id="单位换算"><a href="#单位换算" class="headerlink" title="单位换算"></a>单位换算</h1><p><a href="https://www.convertworld.com/zh-hans/" target="_blank" rel="noopener">https://www.convertworld.com/zh-hans/</a></p>
<p>convertworld是一个比较全的单位换算的网站。我经常用它进行时间单位和货币单位的换算。</p>
<h1 id="在线调色板"><a href="#在线调色板" class="headerlink" title="在线调色板"></a>在线调色板</h1><p><a href="http://tool.chinaz.com/Tools/OnlineColor.aspx" target="_blank" rel="noopener">http://tool.chinaz.com/Tools/OnlineColor.aspx</a></p>
<p>这个对前端开发比较有用，可以在线调色。</p>
<h1 id="ASCII-ART生成"><a href="#ASCII-ART生成" class="headerlink" title="ASCII ART生成"></a>ASCII ART生成</h1><p><a href="http://patorjk.com/software/taag/" target="_blank" rel="noopener">http://patorjk.com/software/taag/</a></p>
<p>常用对照表</p>
<p>ASCII对照表 ： <a href="http://tool.oschina.net/commons?type=4" target="_blank" rel="noopener">http://tool.oschina.net/commons?type=4</a></p>
<p>HTTP状态码 ： <a href="http://tool.oschina.net/commons?type=5" target="_blank" rel="noopener">http://tool.oschina.net/commons?type=5</a></p>
<p>HTTP Content-type ： <a href="http://tool.oschina.net/commons" target="_blank" rel="noopener">http://tool.oschina.net/commons</a></p>
<p>TCP/UDP常见端口参考 ：<a href="http://tool.oschina.net/commons?type=7" target="_blank" rel="noopener">http://tool.oschina.net/commons?type=7</a></p>
<p>HTML转义字符 ： <a href="http://tool.oschina.net/commons?type=2" target="_blank" rel="noopener">http://tool.oschina.net/commons?type=2</a></p>
<p>RGB颜色参考 ： <a href="http://tool.oschina.net/commons?type=3" target="_blank" rel="noopener">http://tool.oschina.net/commons?type=3</a></p>
<p>网页字体参考 ： <a href="http://tool.oschina.net/commons?type=8" target="_blank" rel="noopener">http://tool.oschina.net/commons?type=8</a></p>
]]></content>
      
        <categories>
            
            <category> work </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 工作 </tag>
            
            <tag> work </tag>
            
            <tag> 工具 </tag>
            
            <tag> tools </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[提升工作效率]]></title>
      <url>https://smallwenzi.github.io/2018/05/08/%E5%8D%87%E5%B7%A5%E4%BD%9C%E6%95%88%E7%8E%87/</url>
      <content type="html"><![CDATA[<p>1 时间常有，时间在于优先。</p>
<p>2 时间总会有的：每天只计划 4～5 小时真正的工作。</p>
<p>3 当你在状态时，就多干点；不然就好好休息：有时候会连着几天不是工作状态，有时在工作状态时却又能天天忙活 12 小时，这都很正常的。</p>
<p>4 重视你的时间，并使其值得重视：你的时间值 1000 美元/小时，你得动起来。</p>
<p>5 不要多任务，这只会消耗注意力；保持专注，一心一用。</p>
<p>6、养成工作习惯，并持之以恒，你的身体会适应的。</p>
<p>7.在有限的时间内，我们总是非常专注并且有效率。</p>
<p>8.进入工作状态的最佳方式就是工作，从小任务开始做起，让工作运转起来。</p>
<p>9、迭代工作，期待完美收工会令人窒息：“做完事情，要胜于完美收工” Facebook 办公室墙壁上贴的箴言。动手做，胜过任何完美的想象。</p>
<p>10、工作时间越长，并不等于效率越高</p>
<p>11、按重要性工作，提高效率。</p>
<p>12 有会议就尽早安排，用于准备会议</p>
<p>的时间往往都浪费掉了。</p>
<p>13、把会议和沟通 (邮件或电话) 结合，创造不间断工作时间：一个小会，也会毁了一个下午，因为它会把下午撕成两个较小的时间段，以至于啥也干不成。PS：当看到一个程序员冥思苦想时，不要过去打扰，甚至一句问候都是多余的。</p>
<p>14、一整天保持相同的工作环境。在项目/客户之间切换，会效率低。</p>
<p>15 工作—放松—工作=高效(番茄工作法)</p>
<p>16、把不切实际的任务分割成合理的小任务，只要每天都完成小任务，你就会越来越接近那个大目标了。</p>
<p>17 从来没有两个任务会有相同的优先级，总会有个更重要，仔细考虑待办事情列表。</p>
<p>18 必须清楚白天必须完成的那件事，是什么。“Only ever work on the thing that will have the biggest impact” 只去做那件有着最大影响的事情。</p>
<p>19 把任务按时间分段，就能感觉它快被搞定了。</p>
<p>20 授权并擅用他人的力量。—君子善假于物(人)也，如果某件事其他人也可以做到八成，那就给他做！</p>
<p>21 把昨天翻过去，只考虑今天和明天。昨天的全垒打赢不了今天的比赛。—好汉不提当年勇。</p>
<p>22 给所有事情都设定一个期限。不要让工作无期限地进行下去。</p>
<p>23 针对时间紧或有压力的任务，设置结束时间，万事皆可终结</p>
<p>24 多记，多做笔记</p>
<p>25 进入高效状态后，记下任何分散你注意力的东西比如Google搜索词、灵光乍现的想法、新点子等等。如果你把它们记下来，它就不会再蹦来蹦去了。</p>
<p>26 休息，休息一下～</p>
]]></content>
      
        <categories>
            
            <category> work </category>
            
        </categories>
        
        
        <tags>
            
            <tag> work </tag>
            
            <tag> 工作效率 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Notepad++文本比较插件：Compare]]></title>
      <url>https://smallwenzi.github.io/2017/03/06/tepad-compare/</url>
      <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><br>对程序员来说，文本比较就是代码的比较，对比新老两个版本的代码的差异是经常需要做的事情，尤其是多人开发的代码尤甚，今天，一个转给了同事，然后同事请小长假，代码又回来了，首先就是要了解代码已经修改了哪些地方。<a id="more"></a></excerpt></p>
<p><the rest="" of="" contents="" |="" 余下全文=""><br>承认，现在的人越来越懒，要去下载一款专门的代码比较器太不情愿了，如果现有的工具有这个功能就好了。这还真有，我一直是用的文本编辑器Notepad++就有个插件“Compare”，可以实现对文本（代码）的比较，而且一点也不亚于专用软件。</the></p>
<p>Compare插件的安装很简单，在Notepad++的“插件”菜单中选择“Plugin Manager”-》“show Plugin Manager”，然后再“Available”选项卡内找到“Compare”插件，打勾，按Install。理论上就自动下载安装完毕了。<br>不过现实中经常会出现“Installation of <em>**</em> failed”这样的错误，这是因为在国内访问外国网站的时候链接被重置的缘故，解决方法一：多试几次，通常像sourceforge这样的网站是间歇性不能访问，多试几下就可以了，或者在下方的详细那里复制出下载地址，然后自行通过其他方法下载该插件，然后解压到Notepad++的根目录下的plugins目录即可。</p>
<p>比较的效果还是不错的。</p>
<p>为方便大家，把该插件<a href="https://github.com/smallwenzi/software" target="_blank" rel="noopener">链接</a>共享给大家，下载该“ComparePlugin.dll”文件后，复制到Notepad++安装目录下的\plugins目录即可</p>
]]></content>
      
        
        <tags>
            
            <tag> notepad </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[用GTmetrix来优化你的网页（集成了YSlow、FireBug的功能）]]></title>
      <url>https://smallwenzi.github.io/2017/02/28/gtmetix/</url>
      <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><br>网址是：<a href="http://gtmetrix.com/" target="_blank" rel="noopener">http://gtmetrix.com/</a> ，输入自己需要分析的链接，稍微等会儿，有两个得分，一是YSlow的分析得分，二是PageSpeed的分析得分。<br><a id="more"></a></excerpt></p>
<the rest="" of="" contents="" |="" 余下全文="">

<p><img src="/2017/02/28/gtmetix/1.jpg" alt="logo"><br>一般互联网的网站，得分要达到C（包含A和B）以上，最好能达到B。</p>
<h2 id="YSlow的检查项目"><a href="#YSlow的检查项目" class="headerlink" title="YSlow的检查项目"></a>YSlow的检查项目</h2><h3 id="Leverage-browser-caching-浏览器缓存"><a href="#Leverage-browser-caching-浏览器缓存" class="headerlink" title="Leverage browser caching  浏览器缓存"></a>Leverage browser caching  浏览器缓存</h3><p>  Page load times can be significantly improved by asking visitors to save and reuse the files included in your website. 要求访问者保存和重复使用您网站中包含的文件，可以显着提高页面加载时间。</p>
<h3 id="Specify-a-cache-validator-指定缓存验证器"><a href="#Specify-a-cache-validator-指定缓存验证器" class="headerlink" title="Specify a cache validator 指定缓存验证器"></a>Specify a cache validator 指定缓存验证器</h3><p>All static resources should have either a Last-Modified or ETag header. This will allow browsers to take advantage of the full benefits of caching.所有静态资源应具有Last-Modified或ETag头。 这将允许浏览器利用缓存的全部好处。</p>
<h3 id="Optimize-images-优化图片"><a href="#Optimize-images-优化图片" class="headerlink" title="Optimize images 优化图片"></a>Optimize images 优化图片</h3><p>Reduce the load times of pages by loading appropriately sized images.通过加载适当大小的图像减少页面的加载时间。</p>
<h3 id="Specify-image-dimensions-指定图片大小"><a href="#Specify-image-dimensions-指定图片大小" class="headerlink" title="Specify image dimensions 指定图片大小"></a>Specify image dimensions 指定图片大小</h3><p>Specifying a width and height for all images allows for faster rendering by eliminating the need for unnecessary reflows and repaints.为所有图像指定宽度和高度允许通过消除对不必要的回流和重绘的需要来更快地呈现。</p>
<h3 id="Enable-gzip-compression-启用gzip压缩"><a href="#Enable-gzip-compression-启用gzip压缩" class="headerlink" title="Enable gzip compression 启用gzip压缩"></a>Enable gzip compression 启用gzip压缩</h3><p>Reduce the size of files sent from your server to increase the speed to which they are transferred to the browser.减少从服务器发送的文件的大小，以提高它们传输到浏览器的速度。</p>
<h3 id="Minify-JavaScript-缩小javascript"><a href="#Minify-JavaScript-缩小javascript" class="headerlink" title="Minify JavaScript 缩小javascript"></a>Minify JavaScript 缩小javascript</h3><p>Compacting JavaScript code can save many bytes of data and speed up downloading, parsing, and execution time.压缩JavaScript代码可以节省大量数据字节，并加快下载，解析和执行时间</p>
<h3 id="Minify-HTML-缩小HTML"><a href="#Minify-HTML-缩小HTML" class="headerlink" title="Minify HTML 缩小HTML"></a>Minify HTML 缩小HTML</h3><p>Compacting HTML code, including any inline JavaScript and CSS contained in it, can save many bytes of data and speed up downloading, parsing, and execution time.压缩HTML代码，包括其中包含的任何内联JavaScript和CSS，可以节省许多字节的数据，加快下载，解析和执行时间。</p>
<h3 id="Specify-a-Vary-Accept-Encoding-header"><a href="#Specify-a-Vary-Accept-Encoding-header" class="headerlink" title="Specify a Vary: Accept-Encoding header"></a>Specify a Vary: Accept-Encoding header</h3><p>Bugs in some public proxies may lead to compressed versions of your resources being served to users that don’t support compression. Specifying the Vary: Accept-Encoding header instructs the proxy to store both a compressed and uncompressed version of the resource.一些公共代理中的错误可能导致向不支持压缩的用户提供资源的压缩版本。 指定Vary：Accept-Encoding标头指示代理存储资源的压缩和未压缩版本。</p>
<h3 id="Remove-query-strings-from-static-resources-从静态资源中删除查询字符串"><a href="#Remove-query-strings-from-static-resources-从静态资源中删除查询字符串" class="headerlink" title="Remove query strings from static resources 从静态资源中删除查询字符串"></a>Remove query strings from static resources 从静态资源中删除查询字符串</h3><p>Most proxies, most notably Squid up through version 3.0, do not cache resources with a “?” in their URL even if a Cache-control: public header is present in the response. To enable proxy caching for these resources, remove query strings from references to static resources, and instead encode the parameters into the file names themselves.大多数代理，最引人注目的是Squid通过3.0版本，不缓存资源与“？ 即使在响应中存在Cache-control：public标头，也可以在其URL中查找。 要为这些资源启用代理缓存，请从静态资源引用中删除查询字符串，而不是将参数编入文件名本身。</p>
<h3 id="Avoid-bad-requests-避免不良的请求"><a href="#Avoid-bad-requests-避免不良的请求" class="headerlink" title="Avoid bad requests 避免不良的请求"></a>Avoid bad requests 避免不良的请求</h3><p>Removing “broken links”, or requests that result in 404/410 errors, avoids wasteful requests.删除“损坏的链接”或导致404/410错误的请求，可避免浪费的请求。</p>
<h3 id="Avoid-landing-page-redirects-避免着陆页重定向"><a href="#Avoid-landing-page-redirects-避免着陆页重定向" class="headerlink" title="Avoid landing page redirects 避免着陆页重定向"></a>Avoid landing page redirects 避免着陆页重定向</h3><p>Redirections on landing pages add delays to the page load and while the redirections are occurring, nothing is shown to the client. In many cases, redirections can be eliminated without changing the function of a page.着陆页的重定向会增加页面加载的延迟，并且当重定向发生时，客户端不会显示任何内容。 在许多情况下，可以消除重定向而不改变页面的功能。</p>
<h3 id="Defer-parsing-of-JavaScript-延迟JavaScript的解析"><a href="#Defer-parsing-of-JavaScript-延迟JavaScript的解析" class="headerlink" title="Defer parsing of JavaScript 延迟JavaScript的解析"></a>Defer parsing of JavaScript 延迟JavaScript的解析</h3><p>In order to load a page, the browser must parse the contents of all <script> tags, which adds additional time to the page load. By minimizing the amount of JavaScript needed to render the page, and deferring parsing of unneeded JavaScript until it needs to be executed, you can reduce the initial load time of your page.为了加载页面，浏览器必须解析所有<script>标签的内容，这会给页面加载增加额外的时间。 通过最小化呈现页面所需的JavaScript量，并推迟对不需要的JavaScript进行解析，直到需要执行它，您可以减少页面的初始加载时间。</p>
<h3 id="Enable-Keep-Alive-启用保持活动"><a href="#Enable-Keep-Alive-启用保持活动" class="headerlink" title="Enable Keep-Alive 启用保持活动"></a>Enable Keep-Alive 启用保持活动</h3><p>Enabling HTTP Keep-Alive or HTTP persistent connections allow the same TCP connection to send and receive multiple HTTP requests, thus reducing the latency for subsequent requests.启用HTTP Keep-Alive或HTTP持久连接允许同一TCP连接发送和接收多个HTTP请求，从而减少后续请求的延迟。</p>
<h3 id="Inline-small-CSS-内联小型外部CSS文件"><a href="#Inline-small-CSS-内联小型外部CSS文件" class="headerlink" title="Inline small CSS 内联小型外部CSS文件"></a>Inline small CSS 内联小型外部CSS文件</h3><p>Inlining small external CSS files can save the overhead of fetching these small files. A good alternative to inline CSS is to combine the external CSS files.内联小型外部CSS文件可以节省获取这些小文件的开销。 内联CSS的一个好的替代方法是组合外部CSS文件。</p>
<h2 id="PageSpeed的检查项"><a href="#PageSpeed的检查项" class="headerlink" title="PageSpeed的检查项"></a>PageSpeed的检查项</h2><h2 id="Waterfall"><a href="#Waterfall" class="headerlink" title="Waterfall"></a>Waterfall</h2><h2 id="Timings"><a href="#Timings" class="headerlink" title="Timings"></a>Timings</h2><h2 id="vedio"><a href="#vedio" class="headerlink" title="vedio"></a>vedio</h2><h2 id="Histroy"><a href="#Histroy" class="headerlink" title="Histroy"></a>Histroy</h2></script></p></the>]]></content>
      
        <categories>
            
            <category> 性能优化 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 性能优化 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[java 单例模式]]></title>
      <url>https://smallwenzi.github.io/2017/02/20/Singleton/</url>
      <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><br>在所有的设计模式中，单例模式是我们在项目开发中最为常见的设计模式之一，而单例模式有很多种实现方式，你是否都了解呢？高并发下如何保证单例模式的线程安全性呢？如何保证序列化后的单例对象在反序列化后任然是单例的呢？这些问题在看了本文之后都会一一的告诉你答案，赶快来阅读吧<a id="more"></a></excerpt></p>
<p><the rest="" of="" contents="" |="" 余下全文=""></the></p>
<h1 id="什么是单例模式"><a href="#什么是单例模式" class="headerlink" title="什么是单例模式"></a>什么是单例模式</h1><p>在文章开始之前我们还是有必要介绍一下什么是单例模式。单例模式是为确保一个类只有一个实例，并为整个系统提供一个全局访问点的一种模式方法。<br>从概念中体现出了单例的一些特点：</p>
<blockquote>
<p>（1）、在任何情况下，单例类永远只有一个实例存在<br>（2）、单例需要有能力为整个系统提供这一唯一实例  </p>
</blockquote>
<p>为了便于读者更好的理解这些概念，下面给出这么一段内容叙述：<br>在计算机系统中，线程池、缓存、日志对象、对话框、打印机、显卡的驱动程序对象常被设计成单例。这些应用都或多或少具有资源管理器的功能。每台计算机可以有若干个打印机，但只能有一个Printer Spooler，以避免两个打印作业同时输出到打印机中。每台计算机可以有若干通信端口，系统应当集中管理这些通信端口，以避免一个通信端口同时被两个请求同时调用。总之，选择单例模式就是为了避免不一致状态，避免政出多头。</p>
<p>正是由于这个特点，单例对象通常作为程序中的存放配置信息的载体，因为它能保证其他对象读到一致的信息。例如在某个服务器程序中，该服务器的配置信息可能存放在数据库或文件中，这些配置数据由某个单例对象统一读取，服务进程中的其他对象如果要获取这些配置信息，只需访问该单例对象即可。这种方式极大地简化了在复杂环境 下，尤其是多线程环境下的配置管理，但是随着应用场景的不同，也可能带来一些同步问题。</p>
<h2 id="1、饿汉式单例"><a href="#1、饿汉式单例" class="headerlink" title="1、饿汉式单例"></a>1、饿汉式单例</h2><p>饿汉式单例是指在方法调用前，实例就已经创建好了。下面是实现代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s01;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private static MySingleton instance = new MySingleton();</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static MySingleton getInstance() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以上是单例的饿汉式实现，我们来看看饿汉式在多线程下的执行情况，给出一段多线程的执行代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s01;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(MySingleton.getInstance().hashCode());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        MyThread[] mts = new MyThread[10];</span><br><span class="line">        for(int i = 0 ; i &lt; mts.length ; i++)&#123;</span><br><span class="line">            mts[i] = new MyThread();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int j = 0; j &lt; mts.length; j++) &#123;</span><br><span class="line">            mts[j].start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以上代码运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br><span class="line">15779934</span><br></pre></td></tr></table></figure></p>
<p>从运行结果可以看出实例变量额hashCode值一致，这说明对象是同一个，饿汉式单例实现了</p>
<h2 id="2、懒汉式单例"><a href="#2、懒汉式单例" class="headerlink" title="2、懒汉式单例"></a>2、懒汉式单例</h2><p>懒汉式单例是指在方法调用获取实例时才创建实例，因为相对饿汉式显得“不急迫”，所以被叫做“懒汉模式”。下面是实现代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package org.mlinge.s02;  </span><br><span class="line">  </span><br><span class="line">public class MySingleton &#123;  </span><br><span class="line">      </span><br><span class="line">    private static MySingleton instance = null;  </span><br><span class="line">      </span><br><span class="line">    private MySingleton()&#123;&#125;  </span><br><span class="line">      </span><br><span class="line">    public static MySingleton getInstance() &#123;  </span><br><span class="line">        try &#123;   </span><br><span class="line">            if(instance != null)&#123;//懒汉式   </span><br><span class="line">                  </span><br><span class="line">            &#125;else&#123;  </span><br><span class="line">                //创建实例之前可能会有一些准备性的耗时工作   </span><br><span class="line">                Thread.sleep(300);  </span><br><span class="line">                instance = new MySingleton();  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125; catch (InterruptedException e) &#123;   </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">        return instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里假设在创建实例前有一些准备性的耗时工作要处理，多线程调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s02;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(MySingleton.getInstance().hashCode());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        MyThread[] mts = new MyThread[10];</span><br><span class="line">        for(int i = 0 ; i &lt; mts.length ; i++)&#123;</span><br><span class="line">            mts[i] = new MyThread();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int j = 0; j &lt; mts.length; j++) &#123;</span><br><span class="line">            mts[j].start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>执行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">30863650</span><br><span class="line">7408068</span><br><span class="line">20469344</span><br><span class="line">28235257</span><br><span class="line">23191477</span><br><span class="line">10884088</span><br><span class="line">23667197</span><br><span class="line">20358204</span><br><span class="line">5807702</span><br><span class="line">213274</span><br></pre></td></tr></table></figure></p>
<h2 id="3、线程安全的懒汉式单例"><a href="#3、线程安全的懒汉式单例" class="headerlink" title="3、线程安全的懒汉式单例"></a>3、线程安全的懒汉式单例</h2><p>要保证线程安全，我们就得需要使用同步锁机制，下面就来看看我们如何一步步的解决 存在线程安全问题的懒汉式单例（错误的单例）。</p>
<ul>
<li>（1）方法中声明synchronized关键字<br>出现非线程安全问题，是由于多个线程可以同时进入getInstance()方法，那么只需要对该方法进行synchronized的锁同步即可：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s03;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private static MySingleton instance = null;</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    public synchronized static MySingleton getInstance() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            if(instance != null)&#123;//懒汉式</span><br><span class="line"></span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                //创建实例之前可能会有一些准备性的耗时工作</span><br><span class="line">                Thread.sleep(300);</span><br><span class="line">                instance = new MySingleton();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时任然使用前面验证多线程下执行情况的MyThread类来进行验证，将其放入wen.design.singletonge.s03包下运行，执行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br></pre></td></tr></table></figure>
<p>从执行结果上来看，问题已经解决了，但是这种实现方式的运行效率会很低。同步方法效率低，那我们考虑使用同步代码块来实现：</p>
<ul>
<li>（2）、 同步代码块实现</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s03;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private static MySingleton instance = null;</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    //public synchronized static MySingleton getInstance() &#123;</span><br><span class="line">    public static MySingleton getInstance() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            synchronized (MySingleton.class) &#123;</span><br><span class="line">                if(instance != null)&#123;//懒汉式</span><br><span class="line"></span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    //创建实例之前可能会有一些准备性的耗时工作</span><br><span class="line">                    Thread.sleep(300);</span><br><span class="line">                    instance = new MySingleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的实现能够保证多线程并发下的线程安全性，但是这样的实现将全部的代码都被锁上了，同样的效率很低下。</p>
<ul>
<li>（3）、 针对某些重要的代码进行单独的同步，而不是全部进行同步，可以极大的提高执行效率，我们来看一下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s04;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private static MySingleton instance = null;</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static MySingleton getInstance() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            if(instance != null)&#123;//懒汉式</span><br><span class="line"></span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                //创建实例之前可能会有一些准备性的耗时工作</span><br><span class="line">                Thread.sleep(300);</span><br><span class="line">                synchronized (MySingleton.class) &#123;</span><br><span class="line">                    instance = new MySingleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时同样使用前面验证多线程下执行情况的MyThread类来进行验证，将其放入wen.design.singleton.s04包下运行，执行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">30863650</span><br><span class="line">7408068</span><br><span class="line">20469344</span><br><span class="line">28235257</span><br><span class="line">23191477</span><br><span class="line">10884088</span><br><span class="line">23667197</span><br><span class="line">20358204</span><br><span class="line">20358204</span><br><span class="line">5807702</span><br></pre></td></tr></table></figure></p>
<p>从运行结果来看，这样的方法进行代码块同步，代码的运行效率是能够得到提升，但是却没能保住线程的安全性。看来还得进一步考虑如何解决此问题。</p>
<ul>
<li>（4）、 Double Check Locking 双检查锁机制（推荐）<br>为了达到线程安全，又能提高代码执行效率，我们这里可以采用DCL的双检查锁机制来完成，代码实现如下：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s05;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton &#123;</span><br><span class="line"></span><br><span class="line">    //使用volatile关键字保其可见性</span><br><span class="line">    volatile private static MySingleton instance = null;</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static MySingleton getInstance() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            if(instance != null)&#123;//懒汉式</span><br><span class="line"></span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                //创建实例之前可能会有一些准备性的耗时工作</span><br><span class="line">                Thread.sleep(300);</span><br><span class="line">                synchronized (MySingleton.class) &#123;</span><br><span class="line">                    if(instance == null)&#123;//二次检查</span><br><span class="line">                        instance = new MySingleton();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时同样使用前面验证多线程下执行情况的MyThread类来进行验证，将其放入wen.design.singleton.s05包下运行，执行结果如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br><span class="line">30863650</span><br></pre></td></tr></table></figure></p>
<p>从运行结果来看，该中方法保证了多线程并发下的线程安全性。<br>这里在声明变量时使用了volatile关键字来保证其线程间的可见性；在同步代码块中使用二次检查，以保证其不被重复实例化。集合其二者，这种实现方式既保证了其高效性，也保证了其线程安全性。</p>
<h2 id="4、使用静态内置类实现单例模式"><a href="#4、使用静态内置类实现单例模式" class="headerlink" title="4、使用静态内置类实现单例模式"></a>4、使用静态内置类实现单例模式</h2><p>DCL解决了多线程并发下的线程安全问题，其实使用其他方式也可以达到同样的效果，代码实现如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s06;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton &#123;</span><br><span class="line"></span><br><span class="line">    //内部类</span><br><span class="line">    private static class MySingletonHandler&#123;</span><br><span class="line">        private static MySingleton instance = new MySingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    public static MySingleton getInstance() &#123;</span><br><span class="line">        return MySingletonHandler.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上代码就是使用静态内置类实现了单例模式，这里将前面验证多线程下执行情况的MyThread类放入到wen.design.singleton.s06包下运行，执行结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br><span class="line">1696092</span><br></pre></td></tr></table></figure>
<p>从运行结果来看，静态内部类实现的单例在多线程并发下单个实例得到了保证。</p>
<h2 id="5、序列化与反序列化的单例模式实现"><a href="#5、序列化与反序列化的单例模式实现" class="headerlink" title="5、序列化与反序列化的单例模式实现"></a>5、序列化与反序列化的单例模式实现</h2><p>静态内部类虽然保证了单例在多线程并发下的线程安全性，但是在遇到序列化对象时，默认的方式运行得到的结果就是多例的。<br>代码实现如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s07;</span><br><span class="line"></span><br><span class="line">import java.io.ObjectStreamException;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID = 1L;</span><br><span class="line"></span><br><span class="line">    //内部类</span><br><span class="line">    private static class MySingletonHandler&#123;</span><br><span class="line">        private static MySingleton instance = new MySingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line">    public static MySingleton getInstance() &#123;</span><br><span class="line">        return MySingletonHandler.instance;</span><br><span class="line">    &#125;</span><br><span class="line">    //该方法在反序列化时会被调用，该方法不是接口定义的方法，有点儿约定俗成的感觉</span><br><span class="line">    protected Object readResolve() throws ObjectStreamException &#123;</span><br><span class="line">        System.out.println(&quot;调用了readResolve方法！&quot;);</span><br><span class="line">        return MySingletonHandler.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>序列化与反序列化测试代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s07;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/23.</span><br><span class="line"> */</span><br><span class="line">public class SaveAndReadForSingleton &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        MySingleton singleton = MySingleton.getInstance();</span><br><span class="line"></span><br><span class="line">        File file = new File(&quot;MySingleton.txt&quot;);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            FileOutputStream fos = new FileOutputStream(file);</span><br><span class="line">            ObjectOutputStream oos = new ObjectOutputStream(fos);</span><br><span class="line">            oos.writeObject(singleton);</span><br><span class="line">            fos.close();</span><br><span class="line">            oos.close();</span><br><span class="line">            System.out.println(singleton.hashCode());</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            FileInputStream fis = new FileInputStream(file);</span><br><span class="line">            ObjectInputStream ois = new ObjectInputStream(fis);</span><br><span class="line">            MySingleton rSingleton = (MySingleton) ois.readObject();</span><br><span class="line">            fis.close();</span><br><span class="line">            ois.close();</span><br><span class="line">            System.out.println(rSingleton.hashCode());</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>运行上面的测试代码，得到的结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">19235919</span><br><span class="line">调用了readResolve方法！</span><br><span class="line">19235919</span><br></pre></td></tr></table></figure></p>
<p>从运行结果可知，添加readResolve方法后反序列化后得到的实例和序列化前的是同一个实例，单个实例得到了保证</p>
<h2 id="6、使用static代码块实现单例"><a href="#6、使用static代码块实现单例" class="headerlink" title="6、使用static代码块实现单例"></a>6、使用static代码块实现单例</h2><p>静态代码块中的代码在使用类的时候就已经执行了，所以可以应用静态代码块的这个特性的实现单例设计模式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s08;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line">public class MySingleton&#123;</span><br><span class="line"></span><br><span class="line">    private static MySingleton instance = null;</span><br><span class="line"></span><br><span class="line">    private MySingleton()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    static&#123;</span><br><span class="line">        instance = new MySingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static MySingleton getInstance() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>测试代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s08;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/23.</span><br><span class="line"> */</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        for (int i = 0; i &lt; 5; i++) &#123;</span><br><span class="line">            System.out.println(MySingleton.getInstance().hashCode());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        MyThread[] mts = new MyThread[3];</span><br><span class="line">        for(int i = 0 ; i &lt; mts.length ; i++)&#123;</span><br><span class="line">            mts[i] = new MyThread();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int j = 0; j &lt; mts.length; j++) &#123;</span><br><span class="line">            mts[j].start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br><span class="line">27979955</span><br></pre></td></tr></table></figure></p>
<h2 id="7、使用枚举数据类型实现单例模式"><a href="#7、使用枚举数据类型实现单例模式" class="headerlink" title="7、使用枚举数据类型实现单例模式"></a>7、使用枚举数据类型实现单例模式</h2><p>枚举enum和静态代码块的特性相似，在使用枚举时，构造方法会被自动调用，利用这一特性也可以实现单例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s09;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/22.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public enum EnumFactory&#123;</span><br><span class="line"></span><br><span class="line">    singletonFactory;</span><br><span class="line"></span><br><span class="line">    private MySingleton instance;</span><br><span class="line"></span><br><span class="line">    private EnumFactory()&#123;//枚举类的构造方法在类加载是被实例化</span><br><span class="line">        instance = new MySingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public MySingleton getInstance()&#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MySingleton&#123;//需要获实现单例的类，比如数据库连接Connection</span><br><span class="line">    public MySingleton()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>测试代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s09;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/23.</span><br><span class="line"> */</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(EnumFactory.singletonFactory.getInstance().hashCode());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        MyThread[] mts = new MyThread[10];</span><br><span class="line">        for(int i = 0 ; i &lt; mts.length ; i++)&#123;</span><br><span class="line">            mts[i] = new MyThread();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int j = 0; j &lt; mts.length; j++) &#123;</span><br><span class="line">            mts[j].start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br><span class="line">15055830</span><br></pre></td></tr></table></figure></p>
<p>运行结果表明单例得到了保证，但是这样写枚举类被完全暴露了，据说违反了“职责单一原则”，那我们来看看怎么进行改造呢。</p>
<h2 id="8、完善使用enum枚举实现单例模式"><a href="#8、完善使用enum枚举实现单例模式" class="headerlink" title="8、完善使用enum枚举实现单例模式"></a>8、完善使用enum枚举实现单例模式</h2><p>不暴露枚举类实现细节的封装代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s10;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/23.</span><br><span class="line"> */</span><br><span class="line">public class ClassFactory&#123;</span><br><span class="line"></span><br><span class="line">    private enum MyEnumSingleton&#123;</span><br><span class="line">        singletonFactory;</span><br><span class="line"></span><br><span class="line">        private MySingleton instance;</span><br><span class="line"></span><br><span class="line">        private MyEnumSingleton()&#123;//枚举类的构造方法在类加载是被实例化</span><br><span class="line">            instance = new MySingleton();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public MySingleton getInstance()&#123;</span><br><span class="line">            return instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static MySingleton getInstance()&#123;</span><br><span class="line">        return MyEnumSingleton.singletonFactory.getInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class MySingleton&#123;//需要获实现单例的类，比如数据库连接Connection</span><br><span class="line">    public MySingleton()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>测试代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package wen.design.singleton.s10;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by dell on 2017/2/23.</span><br><span class="line"> */</span><br><span class="line">public class MyThread extends Thread&#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(ClassFactory.getInstance().hashCode());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        MyThread[] mts = new MyThread[10];</span><br><span class="line">        for(int i = 0 ; i &lt; mts.length ; i++)&#123;</span><br><span class="line">            mts[i] = new MyThread();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        for (int j = 0; j &lt; mts.length; j++) &#123;</span><br><span class="line">            mts[j].start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>运行结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br><span class="line">25039388</span><br></pre></td></tr></table></figure></p>
<p>验证结果表明，完善后的单例实现更为合理。<br>以上就是本文要介绍的所有单例模式的实现，相信认真阅读的读者都已经明白文章开头所引入的那几个问题了，祝大家读得开心:-D！</p>
]]></content>
      
        <categories>
            
            <category> java </category>
            
            <category> 设计模式 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> java </tag>
            
            <tag> 单例模式 </tag>
            
            <tag> 设计模式 </tag>
            
            <tag> 线程 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hexo搭建githubpage博客]]></title>
      <url>https://smallwenzi.github.io/2017/02/20/hexo%20git/</url>
      <content type="html"><![CDATA[<p><excerpt in="" index="" |="" 首页摘要=""><br>这是一篇很详尽的独立博客搭建教程 里面介绍了github、Hexo和hexo-admin设置等过程<a id="more"></a></excerpt></p>
<p><the rest="" of="" contents="" |="" 余下全文=""></the></p>
<h2 id="系统环境配置"><a href="#系统环境配置" class="headerlink" title="系统环境配置"></a>系统环境配置</h2><p>要使用Hexo，需要在你的系统中支持Nodejs以及Git，如果还没有，那就开始安装吧！</p>
<h3 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h3><p>下载:<a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a><br>参考地址：<a href="http://www.runoob.com/nodejs/nodejs-install-setup.html" target="_blank" rel="noopener">安装Node.js</a></p>
<h3 id="安装Git"><a href="#安装Git" class="headerlink" title="安装Git"></a>安装Git</h3><p>下载地址：<a href="http://git-scm.com/download/" target="_blank" rel="noopener">git</a></p>
<h3 id="安装hexo"><a href="#安装hexo" class="headerlink" title="安装hexo"></a>安装hexo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> d:/hexo</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-cli -g</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init blog</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> blog</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo s -g <span class="comment">#生成预览</span></span><br></pre></td></tr></table></figure>
<p>$ hexo g == hexo generate  生成静态文件，会在当前目录下生成一个新的叫做public的文件夹<br>$ hexo s == hexo server 启动本地web服务，用于博客的预览<br>$ hexo d == hexo deploy 部署播客到远端（比如github, heroku等平台）</p>
<p>现在我们打开<a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> 已经可以看到一篇内置的blog了。<br><img src="/2017/02/20/hexo git/1.jpeg" alt="logo"></p>
<p>目前我安装所用的本地环境如下：(可以通过hexo -v查看)<br>hexo-cli: 1.0.2<br>os: Windows_NT 6.1.7601 win32 x64<br>http_parser: 2.7.0<br>node: 7.5.0<br>v8: 5.4.500.48<br>uv: 1.10.2<br>zlib: 1.2.8<br>ares: 1.10.1-DEV<br>modules: 51<br>openssl: 1.0.2k<br>icu: 58.2<br>unicode: 9.0<br>cldr: 30.0.3<br>tz: 2016j</p>
<h2 id="Hexo主题设置"><a href="#Hexo主题设置" class="headerlink" title="Hexo主题设置"></a>Hexo主题设置</h2><p>这里以主题yilia为例进行说明。</p>
<h3 id="安装主题-在blog目录下"><a href="#安装主题-在blog目录下" class="headerlink" title="安装主题 (在blog目录下)"></a>安装主题 (在blog目录下)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/litten/hexo-theme-yilia.git themes/yilia</span><br></pre></td></tr></table></figure>
<h3 id="启用主题"><a href="#启用主题" class="headerlink" title="启用主题"></a>启用主题</h3><p>修改Hexo目录下的_config.yml配置文件中的theme属性，将其设置为yilia。</p>
<h3 id="更新主题"><a href="#更新主题" class="headerlink" title="更新主题"></a>更新主题</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> themes/yilia</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git pull</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo s -g</span><br></pre></td></tr></table></figure>
<p>现在打开<a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> ，会看到我们已经应用了一个新的主题。<br><img src="/2017/02/20/hexo git/1.jpeg" alt="logo"></p>
<h2 id="Github-Pages设置"><a href="#Github-Pages设置" class="headerlink" title="Github Pages设置"></a>Github Pages设置</h2><h3 id="什么是Github-Pages"><a href="#什么是Github-Pages" class="headerlink" title="什么是Github Pages"></a>什么是Github Pages</h3><p>GitHub Pages 本用于介绍托管在GitHub的项目，不过，由于他的空间免费稳定，用来做搭建一个博客再好不过了。<br>每个帐号只能有一个仓库来存放个人主页，而且仓库的名字必须是username/username.github.io，这是特殊的命名约定。你可以通过<a href="http://username.github.io" target="_blank" rel="noopener">http://username.github.io</a> 来访问你的个人主页。<br>这里特别提醒一下，需要注意的个人主页的网站内容是在master分支下的。</p>
<p>在这里我创建了一个github repo叫做 smallwenzi.github.io. 创建完成之后，需要有一次提交(git commit)操作，然后就可以通过链接<a href="http://smallwenzi.github.io/">http://smallwenzi.github.io/</a> 访问了。</p>
<p>参考：<a href="http://www.jianshu.com/p/05289a4bc8b2" target="_blank" rel="noopener">配置SSH keys</a></p>
<h2 id="部署Hexo到Github-Pages"><a href="#部署Hexo到Github-Pages" class="headerlink" title="部署Hexo到Github Pages"></a>部署Hexo到Github Pages</h2><p>这一步恐怕是最关键的一步了，让我们把在本地web环境下预览到的博客部署到github上，然后就可以直接通过<a href="http://smallwenzi.github.io/访问了。">http://smallwenzi.github.io/访问了。</a><br>首先需要明白所谓部署到github的原理。<br>1之前步骤中在Github上创建的那个特别的repo（smallwenzi.github.io）一个最大的特点就是其master中的html静态文件，可以通过链接<a href="http://smallwenzi.github.io来直接访问。" target="_blank" rel="noopener">http://smallwenzi.github.io来直接访问。</a><br>2Hexo -g 会生成一个静态网站（第一次会生成一个public目录），这个静态文件可以直接访问。<br>3需要将hexo生成的静态网站，提交(git commit)到github上。<br>明白了原理，怎么做自然就清晰了。</p>
<h3 id="使用hexo-deploy部署"><a href="#使用hexo-deploy部署" class="headerlink" title="使用hexo deploy部署"></a>使用hexo deploy部署</h3><p>hexo deploy可以部署到很多平台，具体可以参考这个<a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">链接</a>. 如果部署到github，需要在配置文件_config.xml中作如下修改：<br>deploy:<br>  type: git<br>  repo: git@github.com:smallwenzi/smallwenzi.github.io.git<br>  branch: master</p>
<p> <img src="/2017/02/20/hexo git/2.png" alt="logo"><br>然后在命令行中执行 (在blog目录下)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo d -g</span><br></pre></td></tr></table></figure>
<p>即可完成部署。现在打开<a href="https://smallwenzi.github.io/">https://smallwenzi.github.io/</a> ，</p>
<p>简单解释一下，hexo generate生成public文件夹下的新内容，然后将其拷贝至smallwenzi.github.io的git目录下，然后使用git commit命令提交代码到smallwenzi.github.io这个repo的master branch上。</p>
<h3 id="Hexo-主题配置"><a href="#Hexo-主题配置" class="headerlink" title="Hexo 主题配置"></a>Hexo 主题配置</h3><p>每个不同的主题会需要不同的配置，主题配置文件在主题目录下的_config.yml。<br>以我们使用的yilia主题为例，其提供如下的配置项（theme\yilia_config.yml）：<br><a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">参考</a>.</p>
<h2 id="Hexo-使用本地图片"><a href="#Hexo-使用本地图片" class="headerlink" title="Hexo 使用本地图片"></a>Hexo 使用本地图片</h2><p>首先确认 _config.yml 中有 post_asset_folder:true 。<br>在 hexo 目录，执行</p>
<p>npm install <a href="https://github.com/CodeFalling/hexo-asset-image" target="_blank" rel="noopener">https://github.com/CodeFalling/hexo-asset-image</a> –save<br>假设在</p>
<p>MacGesture2-Publish<br>├── apppicker.jpg<br>├── logo.jpg<br>└── rules.jpg<br>MacGesture2-Publish.md</p>
<p><img src="/2017/02/20/hexo git/3.png" alt="logo"></p>
<h2 id="Hexo-后台管理配置"><a href="#Hexo-后台管理配置" class="headerlink" title="Hexo 后台管理配置"></a>Hexo 后台管理配置</h2><p>在blog 跟目录下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save hexo-admin</span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server <span class="_">-d</span></span><br></pre></td></tr></table></figure>
<p>如下图：<br><img src="/2017/02/20/hexo git/4.png" alt="logo"><br><a href="https://github.com/jaredly/hexo-admin" target="_blank" rel="noopener">参考</a></p>
]]></content>
      
        <categories>
            
            <category> hexo </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hexo </tag>
            
            <tag> githubpage </tag>
            
            <tag> hexo-admin </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
